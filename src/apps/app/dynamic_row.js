var jsonObj = {"Activate":["Browser","JavaDialog","JavaWindow","SwfWindow","TeWindow","Window","Dialog","OracleFormWindow","OracleList","OracleLogon","OracleNavigator","OracleTree","SAPGuiWindow"],"ActivateRecord":["OracleList","OracleTree","OracleTable"],"Approve":["OracleNotification","OracleFlexWindow"],"CaptureScreen":["JavaWindow","SwfWindow","TeScreen","Browser","SAPGuiWindow","OracleApplications","OracleButton","OracleCalendar","OracleCheckbox","OracleFlexWindow","OracleFormWindow","OracleList","OracleListOfValues","OracleLogon","OracleNavigator","OracleNotification","OraclePicklist","OracleRadioGroup","OracleStatusLine","OracleTabbedRegion","OracleTable","OracleTextField","OracleTree"],"ClearData":["OracleCheckbox"],"Click":["Image","JavaButton","JavaTab","Link","SwfButton","SwfTab","WebButton","WinButton","WebElement","WbfToolbar","SwfObject","OracleButton","OracleFormWindow","OracleTextField","OracleTabbedRegion","OracleApplications","OracleCalendar","OracleCheckbox","OracleFlexWindow","OracleList","OracleListOfValues","OracleLogon","OracleNavigator","OracleNotification","OraclePicklist","OracleRadioGroup","OracleStatusLine","OracleTree","OracleTable","WebEdit","SAPButton","SAPEdit","SAPGuiButton"],"ClickLinkInTable":["WebTable","JavaTable","SAPGuiTable"],"Close":["Browser","JavaWindow","SwfWindow","TeWindow","Window","Page","OracleFormWindow","OracleLogon","OracleNavigator","SAPGuiWindow","SAPGuiSession"],"Collapse":["SwfTreeView","SAPGuiTree","OracleTree"],"ColumnCount":["SAPGuiTable","SAPGuiGrid","SAPGuiAPOGrid"],"Deselect":["OraclePicklist"],"Decline":["OracleNotification"],"DoubleClick":["JavaTree","WebList","WebTable","SwfObject","WebElement","SAPGuiTextArea"],"DragAndDrop":["Page"],"Exists":["Browser","Dialog","JavaButton","JavaCheckBox","JavaEdit","JavaList","JavaMenu","JavaRadioButton","JavaStaticText","JavaTab","JavaTree","JavaWindow","Link","Page","SwdRadioButton","SwfButton","SwfCalendar","SwfCheckBox","SwfComboBox","SwfEdit","SwfList","SwfTable","SwfTreeView","TeField","TeScreen","WebButton","WebCheckBox","WebList","WebRadioGroup","WebTable","Window","OracleTable","OracleRadioGroup","OracleList","OracleFormWindow","OracleCheckbox","OracleButton","OracleApplications","OracleCalendar","OracleFlexWindow","OracleListOfValues","OracleLogon","OracleNavigator","OracleNotification","OracleStatusLine","OracleTabbedRegion","OracleTextField","OracleTree","OraclePicklist"],"Expand":["SwfTreeView","SAPGuiTree",'OracleTree'],"ExpandAll":["SwfTreeView"],"FindRowByText":["TeScreen"],"GetCellData":["OracleTable"],"GetElement":["Browser"],"GetValue":["JavaEdit","JavaObject","JavaStaticText","SwfEdit","SwfObject","TeField","WebEdit","WebElement","OracleTextField","OracleApplications","OracleButton","OracleCalendar","OracleCheckbox","OracleFlexWindow","OracleFormWindow","OracleList","OracleListOfValues","OracleLogon","OracleNavigator","OracleNotification","OraclePicklist","OracleRadioGroup","OracleStatusLine","OracleTabbedRegion","OracleTable","OracleTree","SAPGuiWindow","SAPGuiTree","SAPGuiToolbar","SAPGuiTextArea","SAPGuiTabStrip","SAPGuiTable","SAPGuiStatusBar","SAPGuiSession","SAPGuiRadioButton","SAPGuiOKCode","SAPGuiMenubar","SAPGuiLabel","SAPGuiGrid","SAPGuiElement","SAPGuiEdit","SAPGuiComboBox","SAPGuiCheckBox","SAPGuiButton","SAPGuiAPOGrid"],"GetValuefromXY":["TeScreen"],"Hover":["Image","Link","MenuItem","TabWebButton","WebElement"],"LaunchBrowser":[],"IsEnabled":["OracleButton","OracleCalendar","OracleCheckbox","OracleList","OracleListOfValues","OracleNotification","OraclePicklist","OracleRadioGroup","OracleTabbedRegion","OracleTable","OracleTextField","OracleTree"],"IsChecked":["OracleCheckbox","OracleRadioGroup"],"IsDisabled":["OracleButton","OracleCalendar","OracleCheckbox","OracleList","OracleListOfValues","OracleNotification","OraclePicklist","OracleRadioGroup","OracleTabbedRegion","OracleTable","OracleTextField","OracleTree"],"Maximize":["Browser","JavaWindow","SwfWindow","Window"],"Minimize":["Browser","JavaWindow","SwfWindow","Window"],"Navigate":["Browser"],"OpenApplication":[],"OpenDialog":["OracleTable","OracleTextField"],"OutputValuetoExcel":["JavaEdit","JavaObject","JavaStaticText","SwfEdit","SwfObject","TeField","WebEdit","WebElement"],"PressFunctionKeys":["TeScreen","OracleFormWindow","OracleApplications","OracleButton","OracleCalendar","OracleCheckbox","OracleFlexWindow","OracleList","OracleListOfValues","OracleLogon","OracleNavigator","OracleNotification","OracleRadioGroup","OracleStatusLine","OracleTabbedRegion","OracleTable","OracleTextField"],"PressToolbarButton":["OracleFormWindow","OracleLogon","OracleNavigator"],"PressSpecialKeys":["TeScreen","SAPGuiWindow","SAPGuiTree","SAPGuiToolbar","SAPGuiTable","SAPGuiGrid","SAPGuiComboBox","SAPGuiAPOGrid","OracleApplications","OracleButton","OracleCalendar","OracleCheckbox","OracleFlexWindow","OracleFormWindow","OracleList","OracleListOfValues","OracleLogon","OracleNavigator","OracleNotification","OraclePicklist","OracleRadioGroup","OracleStatusLine","OracleTabbedRegion","OracleTable","OracleTextField","OracleTree"],"RefreshObject":["OracleApplications","OracleButton","OracleCalendar","OracleCheckbox","OracleFlexWindow","OracleFormWindow","OracleList","OracleListOfValues","OracleLogon","OracleNavigator","OracleNotification","OraclePicklist","OracleRadioGroup","OracleStatusLine","OracleTabbedRegion","OracleTable","OracleTextField","OracleTree"],"SearchDataInTable":["OracleTable"],"Select":["JavaCheckBox","JavaList","JavaMenu","JavaRadioButton","JavaTree","SwdRadioButton","SwfCheckBox","SwfComboBox","SwfList","WebCheckBox","WebList","WebRadioGroup","OracleCheckbox","OracleRadioGroup","OracleTabbedRegion"],"SelectContextMenuItem":["OracleApplications","OracleButton","OracleCalendar","OracleCheckbox","OracleFlexWindow","OracleFormWindow","OracleList","OracleListOfValues","OracleLogon","OracleNavigator","OracleNotification","OraclePicklist","OracleRadioGroup","OracleStatusLine","OracleTabbedRegion","OracleTable","OracleTextField","OracleTree"],"SelectFunction":["OracleNavigator"],"SelectMenuItem":["SwfToolBar","OracleFormWindow","OracleLogon","OracleNavigator","SAPGuiWindow","SAPGuiTree","SAPGuiToolbar","SAPGuiGrid"],"SelectMultipleValue":["JavaList","SwfList","WebList"],"SelectRow":["JavaTable","SwfTable","WebTable","SAPGuiTable","SAPGuiGrid","SAPGuiAPOGrid"],"Set":["SAPEdit","WebEdit","WebCheckBox"],"SetCursorPosition":["TeScreen"],"SetFocus":["OracleTable","OracleCheckbox","OracleTextField","OracleRadioGroup"],"Sync":["TeScreen","Browser","Page","SAPGuiSession","OracleApplications"],"SetCellData":["OracleTable"],"Type":["JavaEdit","SwfEdit","TeField","WebEdit","WinEdit","WebElement","WinEditor","OracleTree","OracleRadioGroup","OracleTextField","OracleCalendar","OracleListOfValues","OracleList","OraclePicklist","SAPGuiCheckBox","SAPGuiElement","SAPGuiEdit","SAPGuiComboBox","SAPGuiTree","SAPGuiTextArea","SAPGuiTabStrip","SAPGuiRadioButton","SAPGuiOKCode","SAPGuiMenubar"],"TypeXY":["TeScreen"],"Verify":["OracleTable","OracleFormWindow","OracleTextField","OracleNotification","OracleButton","OracleCalendar","OracleCheckbox","OracleFlexWindow","OracleList","OracleListOfValues","OracleLogon","OracleNavigator","OraclePicklist","OracleRadioGroup","OracleStatusLine","OracleTabbedRegion","OracleTree","WebElement","Browser","WebEdit","Image","Link","WebList","WebTable","Page","WebCheckBox","SAPGuiTextArea","SAPGuiLabel","SAPGuiElement","SAPGuiEdit","SAPGuiWindow","SAPGuiTree","SAPGuiToolbar","SAPGuiTabStrip","SAPGuiTable","SAPGuiStatusBar","SAPGuiSession","SAPGuiRadioButton","SAPGuiOKCode","SAPGuiMenubar","SAPGuiGrid","SAPGuiComboBox","SAPGuiCheckBox","SAPGuiButton","SAPGuiAPOGrid"],"VerifyOption":["OracleList","OracleListOfValues","OraclePicklist","OracleTree"],"VerifyDialog":["Dialog","JavaDialog"],"VerifyItemPresent":["SwfCalendar"],"VerifyItemSelected":["JavaTree","SwfTable","SwfTreeView"],"VerifyPage":["Page"],"VerifyPresent":["Browser","JavaMenu","JavaTab","Link","WebButton","WebCheckBox","WebEdit","WebElement","WebTable","Window"],"VerifyScreen":["TeScreen","SAPGuiWindow"],"VerifySelected":["JavaCheckBox","JavaRadioButton","SwdRadioButton","SwfCheckBox"],"VerifyText":["JavaEdit","JavaList","JavaStaticText","SwfEdit","SwfList","TeField","WebEdit","WebList","WebElement","SAPGuiWindow"],"VerifyTextfromXY":["TeScreen"],"VerifyWindow":["SwfWindow","OracleFlexWindow","OracleFormWindow"],"Wait":["Page"]};
var keys = Object.keys(jsonObj);
var category_dropdown = document.getElementById("tes_cond_action"); 
var action = 'action';
var target_type = '';
var target = '#target#';
var step_data = '$data';
var node_id = '';
var tool_id ='';
var tool_type ='';
var cellView = '';
var actionTestData = '';
var targetTypeTestData = '';
var targetTestData = '';
var testCondDB = new Array();
var testDataDB = new Array();
var nodeSelectedFlag = false;
var testCondCurrentSelectedNode;
var testCondVersion_id;
var testCondModel_id;
var testCondModule_id;
var testCondProject_id;
var testDiagram_id;
var testStepIdGlobal = '';
var testStepRowClicked = '';
var callFromAddDataTable = false;
var callFromAddStepTable = false;
var copyDefaultVersion = false;
var copyBlankVersion = false;
var version_data = '';


//Autoincrement for Sl.No:
function AutoNumber(tableID){
	var table = document.getElementById(tableID); 
	var rowTable = table.rows;
	$(rowTable).each(function (i) {
		$(this).find('span').text(i);
	});
}

var getSelectedItem = function(element, row) {
	autoPopulateItemAction(element, row);
    var e = element;
    var selectedCategory = e.options[e.selectedIndex].value;
	var stepData = (row != null ? row.getElementsByTagName("input")[2] : document.getElementById("tes_cond_step_data"));
	var targetData = (row != null ? row.getElementsByTagName("input")[1] : document.getElementById("tes_cond_target"));
	var actionValue = e.options[e.selectedIndex].value; 
	//Fix for bug in Description where previous data prevailed until new one is fed
	if(targetData.value != ""){
		target = targetData.value;
	}else{
		target = '#target#';
	}
	if(stepData.value != ""){
		step_data = stepData.value;
	}else{
		step_data = '$data';
	}
	//Fix ends
	stepData.disabled = (actionValue === "DragAndDrop" || actionValue === "GetElement" || actionValue === "GetValue" || actionValue === "Navigate" || actionValue === "SelectMultipleValue" || actionValue === "SelectRow" || actionValue === "Type" || actionValue === "VerifyText" || actionValue === "Call" || actionValue === "Expand" || actionValue === "GetElement" || actionValue === "Navigate" || actionValue == 'OpenApplication' || actionValue == 'PressSpecialKeys' || actionValue == 'SearchDataInTable' || actionValue == 'SelectMultipleValue' || actionValue == 'Set' || actionValue == 'SetCursorPosition' || actionValue == 'VerifyItemPresent' || actionValue == 'VerifyItemSelected' || actionValue == 'VerifyText') ? false : true;
	if (actionValue == 'LaunchBrowser' || actionValue == 'Wait' || actionValue == 'GetValuefromXY'){
		targetData.disabled = true;		
		stepData.disabled = false;
	}else{
		targetData.disabled = false;		
	}
    var sub_category_dropdown = (row != null ? row.getElementsByTagName("select")[1] : document.getElementById("tes_cond_targettype"));
    sub_category_dropdown.options.length=0;
    for (var i=0;i<jsonObj[selectedCategory].length;i++) {
        sub_category_dropdown[sub_category_dropdown.length] = new Option(jsonObj[selectedCategory][i],jsonObj[selectedCategory][i]);		
    }	
	autoPopulateItemTarget_Type(sub_category_dropdown[0], row);
	
};

var autoPopulateItemAction = function(element, row) {
    action = element.value;	
	autoDescription(action, target_type, row);
	
};

var autoPopulateItemTarget_Type = function(element, row) {
	if(element!=undefined){
		target_type = element.value;
	}else{
		target_type = '';
	}
     
	var stepData = (row != null ? row.getElementsByTagName("input")[2] : document.getElementById("tes_cond_step_data"));
	var targetData = (row != null ? row.getElementsByTagName("input")[1] : document.getElementById("tes_cond_target"));
	
	//Fix for bug in Description where previous data prevailed until new one is fed
	if(targetData.value != ""){
		target = targetData.value;
	}else{
		target = '#target#';
	}
	if(stepData.value != ""){
		step_data = stepData.value;
	}else{
		step_data = '$data';
	}
	//Fix ends
	
	if(action == 'PressFunctionKeys'  || action == 'Select'  || action == 'SelectMenuItem'   || action == 'SelectRow'){
		targetData.disabled = false;
		stepData.disabled = (target_type === "OracleTextField" || target_type === "OracleFormWindow" || target_type === "JavaCheckBox" || target_type === "JavaMenu" || target_type === "JavaRadioButton" || target_type === "JavaTree" || target_type === "SwdRadioButton" || target_type === "SwfCheckBox" || target_type === "SwfComboBox" || target_type === "WebCheckBox" || target_type === "OracleListofValues" || target_type === "OracleList" || target_type == 'OracleTable') ? true : false;	
	}
	if ((action == 'GetValuefromXY' || action == 'GetValue') && (target_type == 'TeScreen' || target_type == 'OracleTextField')){
		targetData.disabled = false;		
		stepData.disabled = true;
	}else if(action == 'GetValuefromXY' && target_type == 'OracleNotification') {
		targetData.disabled = true;		
		stepData.disabled = false;		
	}else if(action == 'GetValue' && target_type != 'OracleTextField') {
		targetData.disabled = false;		
		stepData.disabled = false;	
	}

	
	autoDescription(action, target_type, row);
};

var autoPopulateItemTarget = function(element, row) {
    target = element.value;	
	
	// code for validation of Action and Target Type (The combination should be unique)
	
	var table = document.getElementById('dataTable'); 
	var rowCount = table.rows.length;
	var rowTable = table.rows;
	var rowInvoked = row.rowIndex +1;
	var currElementAction = (row != null ? row.getElementsByTagName("select")[0] : document.getElementById("tes_cond_action"));
	var currElementTargetType = (row != null ? row.getElementsByTagName("select")[1] : document.getElementById("tes_cond_targettype"));
	var currElementTargetText = (row != null ? row.getElementsByTagName("input")[1] : document.getElementById("tes_cond_target"));
	var currAction = currElementAction.value;
	var currTargetType = currElementTargetType.value;
	var currTargetText = currElementTargetText.value;
	var counter = 1;
	if(rowCount > 2){
	$.each(rowTable, function () {		

	if(counter != rowInvoked && counter >1){
		var elementAction = (this != null ? this.getElementsByTagName("select")[0] : document.getElementById("tes_cond_action"));
		var elementTargetType = (this != null ? this.getElementsByTagName("select")[1] : document.getElementById("tes_cond_targettype"));
		var elementTargetText = (this != null ? this.getElementsByTagName("input")[1] : document.getElementById("tes_cond_target"));
		var action = elementAction.value;
		var targetType = elementTargetType.value;
		var targetText = elementTargetText.value;
		//The below code is no more required as previously it was added because there was no PK-FK was associated in test_step_master and test_data_master table
	/*	if(currAction == action &&  currTargetType == targetType && currTargetText == targetText){
			alert('For selected Action and Target Type the entered target has already been provided, please change the values');
			//currElementTargetText.value = '';
			table.deleteRow(row.rowIndex);
		} */
	}	
	counter++;
		
	});	
	}


//validation ends	
	autoDescription(action, target_type, row);
};

var autoPopulateItemStepData = function(element, row) {
    step_data = element.value;	
	autoDescription(action, target_type, row);
};

/*
var autoPopulateItemCombo1 = function(element, row) {
    var e = element;
    var selectedCategory = e.value;
	var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
	autoPopItem.innerHTML = "";
	autoPopItem.append(selectedCategory)  = selectedCategory;
};
*/

function autoPopulateItemBlank(element, row) {
     var e = element;
    var selectedCategory = e.value;
	var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
	autoPopItem.innerHTML = "";
};

var addRow = function(tableID) {
	
	action = '';
	target_type = '';
	target = '#target#';
	step_data = '$data';
	
	var table = document.getElementById(tableID); 
	var rowCount = table.rows.length;
	var row = table.insertRow(rowCount);
	var colCount = table.rows[0].cells.length;

	for (var i = 0; i<colCount; i++) {
		 var newcell = row.insertCell(i);
		 newcell.innerHTML = table.rows[1].cells[i].innerHTML;
		 //newcell.childNodes[0].selectedIndex = 0;
	} 
	var currElementTargetType = (row != null ? row.getElementsByTagName("select")[1] : document.getElementById("tes_cond_targettype"));
    var selects = row.getElementsByTagName("select");
	var texts = row.getElementsByTagName("input");
	var labels = row.getElementsByTagName("label");
	$(currElementTargetType).empty();
	$(currElementTargetType).prepend('<option selected="selected" value="Select Target Type">Select Target Type</option>');
	autoPopulateItemBlank(this, row);
    selects[0].addEventListener('change', function() { getSelectedItem(this, row) }, false);
	selects[1].addEventListener('change', function() { autoPopulateItemTarget_Type(this, row) }, false);
	texts[1].addEventListener('change', function() { autoPopulateItemTarget(this, row) }, false);
	texts[2].addEventListener('change', function() { autoPopulateItemStepData(this, row) }, false);
	labels[2].addEventListener('click', function() { autoPopulateLabelData(row) }, false);
	AutoNumber('dataTable');
};

var addRowSaveDb = function(tableID) {
	//callFromAddStepTable = true;
	if($('#dataTable').is(':visible')){
		callFromAddStepTable = true; // Fix for Bug, when there was no row in TestSteps and if user add a row and then if clicks save,'Save Successfully' message was not displayed
		$("#save_test_cond").click();
	}
	action = '';
	target_type = '';
	target = '#target#';
	step_data = '$data';
	
	var table = document.getElementById(tableID); 
	var rowCount = table.rows.length;
	var row = table.insertRow(rowCount);
	var colCount = table.rows[0].cells.length;

	for (var i = 0; i<colCount; i++) {
		 var newcell = row.insertCell(i);
		 newcell.innerHTML = table.rows[1].cells[i].innerHTML;
		 //newcell.childNodes[0].selectedIndex = 0;
	} 
	var currElementTargetType = (row != null ? row.getElementsByTagName("select")[1] : document.getElementById("tes_cond_targettype"));
    var selects = row.getElementsByTagName("select");
	var texts = row.getElementsByTagName("input");
	var labels = row.getElementsByTagName("label");
	$(currElementTargetType).empty();
	$(currElementTargetType).prepend('<option selected="selected" value="0">'+ labelObj.selectTargetType +'</option>');
	autoPopulateItemBlank(this, row);
    selects[0].addEventListener('change', function() { getSelectedItem(this, row) }, false);
	selects[1].addEventListener('change', function() { autoPopulateItemTarget_Type(this, row) }, false);
	texts[1].addEventListener('change', function() { autoPopulateItemTarget(this, row) }, false);
	texts[2].addEventListener('change', function() { autoPopulateItemStepData(this, row) }, false);
	labels[2].addEventListener('click', function() { autoPopulateLabelData(row) }, false);
	AutoNumber('dataTable');
	setTimeout(function(){insert_test_cond(row);}, 30);	// this is to delay the call as quick call was sometimes didn't invoke insert_test_cond()
	setTimeout(function(){renderTestCondition(cellView);}, 30);	// this is to delay the call as quick call was sometimes didn't invoke renderTestCondition()
	$('#display_msg_test_step').hide();
	$('#save_test_cond').prop( "disabled", false );
	$('#dataTable').show();
};


var autoDescription = function(action, targettype, row) {
	var e_action = action;  
	var e_targettype = targettype;
    
	if(e_action == 'Activate'){		
		if(e_targettype == 'Browser')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Activate the " + target + " Browser";
		}
		else if(e_targettype == 'JavaDialog')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Activate the " + target + " dialog window";
		}
		else if(e_targettype == 'JavaWindow')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Activate the " + target + " window";
		}
		else if(e_targettype == 'SwfWindow')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Activate the " + target + " window";
		}
		else if(e_targettype == 'TeWindow')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Activate the " + target + " window";
		}
		else if(e_targettype == 'Window')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Activate the " + target + " window";
		}
		else if(e_targettype == 'Dialog')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Activate the " + target + " dialogbox";
		}
		else if(e_targettype == 'OracleFormWindow' || e_targettype == 'OracleLogon' || e_targettype == 'OracleNavigator')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Activate " + target;
		}
		else if(e_targettype == 'SAPGuiWindow')
          {
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Activate the " + target + " window ";
		  }

		
	}
	else if(e_action == 'ActivateRecord'){	
         if(e_targettype == 'OracleList' || e_targettype == 'OracleTree' || e_targettype == 'OracleTable'){
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Activate  " + target + " for $data ";
		 }
	}
	else if(e_action == 'Call'){
		
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Call using " + step_data;
		
	}	
	else if(e_action == 'CaptureScreen'){
		if(e_targettype == 'JavaWindow')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Take screenshot of " + target + " Window";
		}
		else if(e_targettype == 'SwfWindow')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Take screenshot of " + target + " Window";
		}
		else if(e_targettype == 'TeScreen')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Take screenshot of " + target + " Screen";
		}
		else if(e_targettype == 'Browser')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Take screenshot of " + target + " Browser";
		}
		else if(e_targettype == 'SAPGuiWindow')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Take screenshot of " + target;
		}		
	}
	else if(e_action == 'ClearData' && e_targettype == 'OracleCheckbox'){
		
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Clear Data from" + target;
		
	}
	else if(e_action == 'Click'){
		if(e_targettype == 'Image')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Click on  " + target + " image";
		}
		else if(e_targettype == 'JavaButton')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Click on  " + target + " button";
		}
		else if(e_targettype == 'JavaTab')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Click on  " + target + " tab";
		}		
		else if(e_targettype == 'Link')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Click on  " + target + " Link";
		}
		else if(e_targettype == 'SwfButton')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Click on  " + target + " button";
		}
		else if(e_targettype == 'SwfTab')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Click on  " + target + " Tab";
		}
		else if(e_targettype == 'WebButton')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Click on  " + target + " button";
		}
		else if(e_targettype == 'WinButton')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Click on  " + target + " button";
		}
		else if(e_targettype == 'WebElement')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Click on  " + target + " WebElement";
		}
		else if(e_targettype == 'WbfToolbar')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Click on  " + target + " toolbar";
		}
		else if(e_targettype == 'SwfObject')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Click on  " + target + " Object";
		}
		else if(e_targettype == 'OracleButton')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Click on  " + target + " button";
		}
		else if(e_targettype == 'OracleFormWindow')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Click on  " + target + " window";
		}
		else if(e_targettype == 'OracleTextField' || e_targettype == 'OracleApplications' || e_targettype == 'OracleCalendar'
				|| e_targettype == 'OracleCheckbox' || e_targettype == 'OracleFlexWindow' || e_targettype == 'OracleList'
				|| e_targettype == 'OracleListOfValues' || e_targettype == 'OracleLogon' || e_targettype == 'OracleNavigator'
				|| e_targettype == 'OracleNotification' || e_targettype == 'OraclePicklist' || e_targettype == 'OracleRadioGroup'
				|| e_targettype == 'OracleStatusLine' || e_targettype == 'OracleTree' || e_targettype == 'OracleTree' || e_targettype =='OracleTable'
			    || e_targettype == 'OracleFormWindow' || e_targettype == 'OracleLogon' || e_targettype == 'OracleNavigator' || e_targettype == 'OracleApplications')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Click on  " + target;
		}
		else if(e_targettype == 'OracleTabbedRegion')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Click on  " + target;
		}
		else if(e_targettype == 'WebEdit')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Click " + target;
		}
		else if(e_targettype == 'SAPGuiButton')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Click " + target;
		}
		else if(e_targettype == 'SAPButton')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Click " + target;
		}
		else if(e_targettype == 'SAPEdit')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Click " + target;
		}		
	}
	else if(e_action == 'ClickLinkInTable'){
		if(e_targettype == 'JavaTable')
		{
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Click on " + target + " link in the table";
		}
		else if(e_targettype == 'WebTable')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Click on " + target + " link in the table";
		}
		else if(e_targettype == 'SAPGuiTable')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Click on " + target + " link in the table";
		}
	}
	else if(e_action == 'Close'){
		if(e_targettype == 'Browser')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Close " + target + " " + e_targettype;
		}
		else if(e_targettype == 'JavaWindow')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Close " + target + " window";
		}
		else if(e_targettype == 'SwfWindow')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Close " + target + " window";
		}
		else if(e_targettype == 'TeWindow')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Close " + target + " window";
		}
		else if(e_targettype == 'Window')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Close " + target + " " + e_targettype;
		}
		else if(e_targettype == 'Page')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Close the page " + target;
		}
		else if(e_targettype == 'OracleFormWindow')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Close " + target + " window";
		}
		else if(e_targettype == 'SAPGuiWindow' || e_targettype == 'SAPGuiSession')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Close " + target;
		}
	}
	
	else if(e_action == 'Collapse'){
		if(e_targettype == 'SwfTreeView' || e_targettype == 'SAPGuiTree'){
			
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Close the " + target + " tree view";
		}
	   else if(e_targettype == 'OracleTree'){
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Close the $data node of " + target + " tree view";
	   }	
     }  	
	
	else if(e_action == 'ColumnCount'){ 
		 if(e_targettype == 'SAPGuiTable' || e_targettype == "SAPGuiGrid" || e_targettype == "SAPGuiAPOGrid"){
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Get Column Count from " + target;
		}
		
	 }	
	else if(e_action == 'DoubleClick'){
		if(e_targettype == 'JavaTree')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Double Click on " + target + " in a tree hierarchy";
		}
		else if(e_targettype == 'WebList')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Double Click on " + target + " in the list";
		}
		else if(e_targettype == 'WebTable')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Double Click on " + target + " in the table";
		}
		else if(e_targettype == 'SwfObject')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "DoubleClick " + target + " object";
		}
		else if(e_targettype == 'WebElement')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "DoubleClick " + target;
		}
		else if(e_targettype == "SAPGuiTextArea")
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "DoubleClick on " + target;
		}
	}
	else if(e_action == 'DragAndDrop' && e_targettype == 'Page'){
		
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "DragAndDrop " + step_data + " " + target;
	}
	else if(e_action == 'Exists'){
		if(e_targettype == 'Browser')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + e_targettype + " exists";
		}
		else if(e_targettype == 'Dialog')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " dialog box exists";
		}
		else if(e_targettype == 'JavaButton')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " button exists";
		}
		else if(e_targettype == 'JavaCheckBox')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " Checkbox exists";
		}
		else if(e_targettype == 'JavaEdit')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " text box exists";
		}
		else if(e_targettype == 'JavaList')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " list exists";
		}
		else if(e_targettype == 'JavaMenu')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " Menu exists";
		}
		else if(e_targettype == 'JavaRadioButton')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " radio group exists";
		}
		else if(e_targettype == 'JavaStaticText')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + "  text box exists";
		}
		else if(e_targettype == 'JavaTab')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + "  tab exists";
		}
		else if(e_targettype == 'JavaTree')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " tree hierarchy exists";
		}
		else if(e_targettype == 'JavaWindow')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " window exists";
		}
		else if(e_targettype == 'Link')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " link exists";
		}
		else if(e_targettype == 'Page')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " " + e_targettype + " exists";
		}
		else if(e_targettype == 'SwdRadioButton')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " radio group exists";
		}
		else if(e_targettype == 'SwfButton')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " button exists";
		}
		else if(e_targettype == 'SwfCalendar')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " calendar exists";
		}
		else if(e_targettype == 'SwfCheckBox')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " check box exists";
		}
		else if(e_targettype == 'SwfComboBox')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " combo box exists";
		}
		else if(e_targettype == 'SwfEdit')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " text box exists";
		}
		else if(e_targettype == 'SwfList')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " list exists";
		}
		else if(e_targettype == 'SwfTable')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " table exists";
		}
		else if(e_targettype == 'SwfTreeView')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " Tree hierarchy exists";
		}
		else if(e_targettype == 'TeField')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " field exists";
		}
		else if(e_targettype == 'TeScreen')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " screen exists";
		}
		else if(e_targettype == 'WebButton')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " button exists";
		}
		else if(e_targettype == 'WebCheckBox')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " checkbox exists";
		}
		else if(e_targettype == 'WebList')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " list exists";
		}
		else if(e_targettype == 'WebRadioGroup')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " radio group exists";
		}
		else if(e_targettype == 'WebTable')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " table exists";
		}
		else if(e_targettype == 'Window')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " exists";
		}
		else if(e_targettype == 'OracleTable')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " " + e_targettype+" exists";
		}
		else if(e_targettype == 'OracleRadioGroup')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " " + e_targettype+" exists";
		}
		else if(e_targettype == 'OracleList')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " " + e_targettype+" exists";
		}
		else if(e_targettype == 'OracleFormWindow')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " " + e_targettype+" exists";
		}
		else if(e_targettype == 'OracleCheckbox')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " " + e_targettype+" exists";
		}
		else if(e_targettype == 'OracleButton')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " " + e_targettype+" exists";
		}
		else if(e_targettype == 'OracleApplications' || e_targettype == 'OracleCalendar' || e_targettype == 'OracleFlexWindow'
				|| e_targettype == 'OracleListOfValues' || e_targettype == 'OracleLogon' || e_targettype == 'OracleNavigator'
				|| e_targettype == 'OracleNotification' || e_targettype == 'OracleStatusLine'  || e_targettype == 'OracleTabbedRegion'
				|| e_targettype == 'OracleTextField' || e_targettype == 'OracleTree' || e_targettype == 'OraclePicklist')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " exists";
                 
		}
		
	}
	
	else if(e_action == 'Expand'){
		if(e_targettype == 'SwfTreeView' || e_targettype == 'SAPGuiTree' || e_targettype == 'OracleTree'){
			
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Expand $data node of the " + target + " Tree";
		}
		
    }	
	
	else if(e_action == 'ExpandAll' && e_targettype == 'SwfTreeView'){
		
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Expand the complete " + target + " Tree hierarchy";
	}
	
	else if(e_action == 'FindRowByText' && e_targettype == 'TeScreen'){
		
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Find the row by search text in " + target + " screen";
	}
	
	else if(e_action == 'GetElement' && e_targettype == 'Browser'){
		
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "GetElement " + step_data + " " + target + " " + e_targettype;
	}
	else if(e_action == 'GetValue'){
		if(e_targettype == 'JavaEdit')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Read the value from " + target + " field and store in " + step_data + " variable";
		}
		else if(e_targettype == 'JavaObject')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Read the value from " + target + " field and store in " + step_data + " variable";
		}
		else if(e_targettype == 'JavaStaticText')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Read the value from " + target + " field and store in " + step_data + " variable";
		}
		else if(e_targettype == 'SwfEdit')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Read the value from " + target + " field and store in " + step_data + " variable";
		}
		else if(e_targettype == 'SwfObject')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Read the value from " + target + " field and store in " + step_data + " variable";
		}
		else if(e_targettype == 'TeField')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Read the value from " + target + " field and store in " + step_data + " variable";
		}
		else if(e_targettype == 'WebEdit')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Read the value from " + target + " field and store in " + step_data + " variable";
		}
		else if(e_targettype == 'WebElement')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Read the value from " + target + " field and store in " + step_data + " variable";
		}
		else if(e_targettype == 'OracleTextField' ||e_targettype == 'OracleApplications' || e_targettype =='OracleButton'
		  || e_targettype == 'OracleCalendar' || e_targettype == 'OracleCheckbox' || e_targettype == 'OracleFlexWindow'
		  || e_targettype == 'OracleFormWindow' || e_targettype == 'OracleList' || e_targettype == 'OracleListOfValues'
		  || e_targettype == 'OracleLogon' || e_targettype == 'OracleNavigator' || e_targettype == 'OracleNotification'
		  || e_targettype == 'OraclePicklist' || e_targettype == 'OracleRadioGroup' || e_targettype == 'OracleStatusLine'
		  || e_targettype == 'OracleTabbedRegion' || e_targettype == 'OracleTable' || e_targettype == 'OracleTree')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Read the $property value from " + target + " field and store in $data variable";
		}
		else if(e_targettype == 'SAPGuiWindow' || e_targettype == 'SAPGuiTree' || e_targettype == 'SAPGuiToolbar' 
		|| e_targettype == 'SAPGuiTextArea' || e_targettype == 'SAPGuiTabStrip' || e_targettype == 'SAPGuiTable' || e_targettype == 'SAPGuiStatusBar'
		|| e_targettype == 'SAPGuiSession' || e_targettype == 'SAPGuiRadioButton' || e_targettype == 'SAPGuiOKCode'
		|| e_targettype == 'SAPGuiMenubar' || e_targettype == 'SAPGuiLabel' || e_targettype == 'SAPGuiGrid'
		|| e_targettype == 'SAPGuiElement' || e_targettype == 'SAPGuiEdit' || e_targettype == 'SAPGuiComboBox'
	    || e_targettype == 'SAPGuiCheckBox' || e_targettype == 'SAPGuiButton' || e_targettype == 'SAPGuiAPOGrid'){
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Read the $property value from " + target+ " field and store in $data variable";
		}
	}
	
	else if(e_action == 'GetValuefromXY'){
		if(e_targettype == 'TeScreen')
		{
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Read the value from the " + target + " screen at given x, y co-ordinates and store in the given variable";
		}
		//This condition is commeted as per oracle ETA team "2/19/2019"
		/*else if(e_targettype == 'OracleNotification')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "GetValuefromXY using " + step_data;
		}*/
	}
	
	else if(e_action == 'LaunchBrowser' && e_targettype == ''){
		
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Launch the " + step_data + " browser and navigate to $URL";
	}
	else if(e_action == 'Maximize'){
		if(e_targettype == 'Browser')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Maximize the " + target + " " + e_targettype;
		}
		else if(e_targettype == 'JavaWindow')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Maximize the " + target + " window";
		}
		else if(e_targettype == 'SwfWindow')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Maximize the " + target + " Window";
		}
		else if(e_targettype == 'Window')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Maximize the " + target + " " + e_targettype;
		}
	}
	else if(e_action == 'Minimize'){
		if(e_targettype == 'Browser')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Minimize the " + target + " " + e_targettype;
		}
		else if(e_targettype == 'JavaWindow')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Minimize the " + target + " window";
		}
		else if(e_targettype == 'SwfWindow')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Minimize the " + target + " Window";
		}
		else if(e_targettype == 'Window')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Minimize the " + target + " " + e_targettype;
		}
	}
	else if(e_action == 'Navigate' && e_targettype == 'Browser'){
		
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Navigate to "  + step_data + " URL using " + target + " browser";
	}
	else if(e_action == 'OpenApplication' && e_targettype == ''){
		
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Open " + target + " Application with " + step_data+ " Arguments";
		}
	else if(e_action == 'OutputValuetoExcel'){
		if(e_targettype == 'JavaEdit' || e_targettype == 'JavaObject'|| e_targettype == 'JavaStaticText'|| e_targettype == 'SwfEdit'|| e_targettype == 'SwfObject'|| e_targettype == 'TeField'|| e_targettype == 'WebEdit'|| e_targettype == 'WebElement')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Output the " + target + " field value to excel";
		}
	}
	
	else if(e_action == 'PressFunctionKeys'){
		if(e_targettype == 'TeScreen')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Press " + step_data + " Function Key on " + target + "screen";
		}
		else if(e_targettype == 'OracleFormWindow' || e_targettype == 'OracleApplications' || e_targettype == 'OracleButton'
				|| e_targettype == 'OracleCalendar' || e_targettype == 'OracleCheckbox' || e_targettype == 'OracleFlexWindow'
				|| e_targettype == 'OracleList' || e_targettype == 'OracleListOfValues' || e_targettype == 'OracleLogon'
				|| e_targettype == 'OracleNavigator' || e_targettype == 'OracleNotification' || e_targettype == 'OracleRadioGroup'
				|| e_targettype == 'OracleStatusLine' || e_targettype == 'OracleTabbedRegion' || e_targettype == 'OracleTable'
			    || e_targettype == 'OracleTextField')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Press $data function key on "+ target;
		}
	}
	
	else if(e_action == 'PressSpecialKeys'){
	  if(e_targettype == 'TeScreen'){
		
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Press " + step_data + " Key on " + target + " screen";
	  }
	  if(e_targettype == 'SAPGuiWindow' || e_targettype == 'SAPGuiTree' || e_targettype == 'SAPGuiToolbar'
	   || e_targettype == 'SAPGuiTable' || e_targettype == 'SAPGuiGrid' || e_targettype == 'SAPGuiComboBox' 
	   || e_targettype == 'SAPGuiAPOGrid'){
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Press $data Key on " + target;
	  }
    } 	
	
	else if(e_action == 'SearchDataInTable' && e_targettype == 'OracleTable'){
		
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Search $Parama data in " + target + " table";
	}
	
	else if(e_action == 'Select'){
		if(e_targettype == 'JavaCheckBox')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Select " + target + " Checkbox";
		}
		else if(e_targettype == 'JavaList')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Select " + step_data + " from "+ target + " list";
		}
		else if(e_targettype == 'JavaMenu')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Select " + target + " Menu";
		}
		else if(e_targettype == 'JavaRadioButton')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Select " + target + " Radio Button";
		}
		else if(e_targettype == 'JavaTree')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Select " + target + " in tree hierarchy";
		}
		else if(e_targettype == 'SwdRadioButton')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Select " + target + "  radio button";
		}
		else if(e_targettype == 'SwfCheckBox')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Select " + target + "  checkbox";
		}
		else if(e_targettype == 'SwfComboBox')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Select " + target + " combo box";
		}
		else if(e_targettype == 'SwfList')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Select " + step_data + " from the "+ target + " list";
		}
		else if(e_targettype == 'WebCheckBox')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Select the " + target + "checkbox";
		}
		else if(e_targettype == 'WebList')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Select " + step_data + " from the "+ target + " list";
		}
		else if(e_targettype == 'WebRadioGroup')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Select $value from " + target + " Radio Button from the list";
		}
		else if(e_targettype == 'OracleCheckbox')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "select " + target + " check box";
		}
		else if(e_targettype == 'OracleRadioGroup')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "set " + step_data + " for the "+ target + " check box";
		}
		else if(e_targettype == 'OracleTabbedRegion')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Select " + target + " OracleTabbedRegion";
		}
		else if(e_targettype == 'OracleApplications' || e_targettype == 'OracleButton' || e_targettype == 'OracleCalendar'
				|| e_targettype == 'OracleFlexWindow' || e_targettype == 'OracleFormWindow' || e_targettype == 'OracleList'
				|| e_targettype == 'OracleListOfValues' || e_targettype == 'OracleLogon' || e_targettype =='OracleNavigator'
				|| e_targettype == 'OracleNotification' || e_targettype == 'OracleStatusLine' || e_targettype == 'OracleTable'
			    || e_targettype == 'OracleTextField' || e_targettype == 'OracleTree'){
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Press $data key on " + target;
		}
	}
	else if(e_action == 'SelectMenuItem'){
		if(e_targettype == 'SwfToolBar' || e_targettype =='SAPGuiWindow' || e_targettype =='SAPGuiTree'
	    || e_targettype == 'SAPGuiToolbar' || e_targettype == 'SAPGuiGrid')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Select $data option from "+ target + " Menu list";
		}
		else if(e_targettype == 'OracleFormWindow' || e_targettype == 'OracleLogon' || e_targettype == 'OracleNavigator')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "SelectMenuItem $data for " + target;
		}
	}
	else if(e_action == 'SelectMultipleValue'){
		if(e_targettype == 'JavaList' || e_targettype == 'SwfList')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Select " + step_data + " values from "+ target + " list";
		}
		else if(e_targettype == 'WebList')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Select " + step_data + " row from the " + target + " table";
		}
	}
	
	else if(e_action == 'SelectRow'){
		if(e_targettype == 'JavaTable' || e_targettype == 'SwfTable' || e_targettype == 'WebTable')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Select " + step_data + " row from the " + target + " table";
		}
		/*else if(e_targettype == 'OracleTable')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "SelectRow " + target;
		} */
		else if(e_targettype == 'SAPGuiTable' || e_targettype == 'SAPGuiGrid' || e_targettype == 'SAPGuiAPOGrid'){
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Select $data row from the " + target;
		}
	}
	
	else if(e_action == 'Set' && e_targettype == 'WebCheckBox'){
		
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Set " + step_data + " for " + target + " checkbox";
	}
	else if(e_action == 'Set' && (e_targettype == 'WebEdit' || e_targettype == 'SAPEdit') ){
		
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Set " + step_data + " for " + target;
	}
	else if(e_action == 'SetCursorPosition' && e_targettype == 'TeScreen'){
		
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Set cursor positions at " + step_data + " on " + target + " screen";
	}
	
	else if(e_action == 'SetFocus' ){
	   if(e_targettype == 'OracleTable')	
	  {	
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "SetFocus on " + target + " using $row and $col";
	  }
	  else if(e_targettype == 'OracleCheckbox' || e_targettype == 'OracleRadioGroup'  || e_targettype == 'OracleTextField')
	  {
        var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "SetFocus on " + target;
	  }	
	}
	else if(e_action == 'Sync'){
		if(e_targettype == 'TeScreen' || e_targettype == 'SAPGuiSession')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Wait till the " + target + " screen is loaded sucessfully";
		}
		else if(e_targettype == 'Page')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Wait till the " + target + " page is loaded sucessfully";
		}
		else if(e_targettype == 'Browser')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Wait till the " + target + " browser is loaded sucessfully";
		}
		else if (e_targettype == 'OracleApplications'){
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Wait till the " + target + " application is loaded sucessfully ";
		}
	}
	else if(e_action == 'Type'){
		if(e_targettype == 'JavaEdit')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Set " + step_data + " in " + target + " field";
		}
		else if(e_targettype == 'SwfEdit' || e_targettype == 'TeField'|| e_targettype == 'WebEdit'|| e_targettype == 'WinEdit' || e_targettype == 'OracleTextField'
		|| e_targettype == 'SAPGuiCheckBox' || e_targettype == 'SAPGuiElement' || e_targettype == 'SAPGuiEdit'
		|| e_targettype == 'SAPGuiComboBox' || e_targettype == 'SAPGuiTree' || e_targettype == 'SAPGuiTextArea'
	    || e_targettype == 'SAPGuiTabStrip' || e_targettype == 'SAPGuiRadioButton' || e_targettype == 'SAPGuiOKCode' || e_targettype == 'SAPGuiMenubar')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Type $data in " + target + " field";
		}
		else if(e_targettype == 'WebElement' || e_targettype == 'WinEditor')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Type " + target + " " + step_data;
		}
	    else if(e_targettype == 'OracleRadioGroup'){
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Select $data for the " + target + " radio group";
		}	
		else if(e_targettype == 'OracleListOfValues' || e_targettype == 'OracleList' || e_targettype == 'OraclePicklist'
				|| e_targettype == 'OracleTree')
		{
            var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Select $data for the " + target;        
		}
        else if(e_targettype == 'OracleTextField' || e_targettype == 'OracleCalendar'){
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Type $data in " + target + " field";     
		}
	}	
	else if(e_action == 'TypeXY' && e_targettype == 'TeScreen'){
		
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Type the text at given co-ordinates in " + target + " screen";
	}	
	
	else if(e_action == 'Verify'){
		if(e_targettype == 'WebElement' || e_targettype == 'Browser' || e_targettype == 'WebEdit'
		|| e_targettype == 'Image' || e_targettype == 'Link' || e_targettype == 'WebList' 
		|| e_targettype == 'WebTable' || e_targettype == 'Page' || e_targettype == 'WebCheckBox')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify " + target;
		}
		if(e_targettype == "SAPGuiTextArea" || e_targettype == "SAPGuiLabel" || e_targettype == "SAPGuiElement" || e_targettype == "SAPGuiEdit"
		 || e_targettype == "SAPGuiWindow" || e_targettype == "SAPGuiTree" || e_targettype == "SAPGuiToolbar" || e_targettype == "SAPGuiTabStrip"
		 || e_targettype == "SAPGuiTable" || e_targettype == "SAPGuiStatusBar" || e_targettype == "SAPGuiSession"
		 || e_targettype == "SAPGuiRadioButton" || e_targettype == "SAPGuiOKCode" || e_targettype == "SAPGuiMenubar"
		 || e_targettype == "SAPGuiGrid" || e_targettype == "SAPGuiComboBox" || e_targettype == "SAPGuiCheckBox" || e_targettype == "SAPGuiButton" || e_targettype == "SAPGuiAPOGrid"){
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify " + target + " with $data" ;
		}
		if(e_targettype == 'OracleTable' || e_targettype == 'OracleFormWindow'|| e_targettype == 'OracleTextField' 
		   || e_targettype == 'OracleNotification' || e_targettype == 'OracleButton' || e_targettype == 'OracleCalendar'
		   || e_targettype == 'OracleCheckbox' || e_targettype == 'OracleFlexWindow' || e_targettype == 'OracleList'
		   || e_targettype == 'OracleListOfValues' || e_targettype == 'OracleLogon' || e_targettype == 'OracleNavigator'
		   || e_targettype == 'OraclePicklist' || e_targettype == 'OracleRadioGroup' || e_targettype == 'OracleStatusLine'
		   || e_targettype == 'OracleStatusLine' || e_targettype == 'OracleTree')
		   {
				var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
				autoPopItem.innerHTML = "";
				autoPopItem.innerHTML = "Verify " + target + " with $data" ;
		   }
	}	
	else if(e_action == 'VerifyDialog'){
		if(e_targettype == 'Dialog' || e_targettype == 'JavaDialog')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether " + target + " dialog is displayed";
		}
	}
	else if(e_action == 'VerifyItemPresent' && e_targettype == 'SwfCalendar'){
		
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Verify whether " + step_data + " is present in " + target + " calendar";
	}
	else if(e_action == 'VerifyItemSelected'){
		if(e_targettype == 'JavaTree')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether the " + step_data + " item is selected in " + target + " tree hierarchy";
		}
		else if(e_targettype == 'SwfTable')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether the " + step_data + " value is selected in " + target + " table";
		}
		else if(e_targettype == 'SwfTreeView')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether the " + step_data + " value is selected in " + target + " tree hierarchy";
		}
	}
	else if(e_action == 'VerifyPage' && e_targettype == 'Page'){
		
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Verify whether " + target + " page is displayed";
	}
	else if(e_action == 'VerifyPresent'){
		if(e_targettype == 'Browser' || e_targettype == 'WebTable' ||e_targettype == 'Window')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether the " + target + " " + e_targettype + " is present";
		}
		else if(e_targettype == 'JavaMenu')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether the " + target + " menu is present";
		}
		else if(e_targettype == 'JavaTab')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether the " + target + " tab is present";
		}
		else if(e_targettype == 'Link')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether the " + target + " link is present";
		}
		else if(e_targettype == 'WebButton')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether the " + target + " button is present";
		}
		else if(e_targettype == 'WebCheckBox')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether the " + target + " checkbox is present";
		}
		else if(e_targettype == 'WebEdit')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether the " + target + " field is present";
		}
		else if(e_targettype == 'WebElement')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether the " + target + " element present";
		}	
	}	
	else if(e_action == 'VerifyScreen'){ 
		if(e_targettype == 'TeScreen'){
			
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether the " + target + " screen present";
		}	
		else if(e_targettype == 'SAPGuiWindow'){
			
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether  " + target + " screen is displayed";
		}	
 	 }	
	else if(e_action == 'VerifySelected'){
		if(e_targettype == 'JavaCheckBox')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether the " + target + " checkbox is selected";
		}
		else if(e_targettype == 'JavaRadioButton' || e_targettype ==  'SwdRadioButton')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether the " + target + " radio button is selected";
		}
		else if(e_targettype == 'SwfCheckBox')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether the " + target + " check box is selected";
		}
	}		
	else if(e_action == 'VerifyText'){
		if(e_targettype == 'WebEdit' || e_targettype ==  'JavaEdit' || e_targettype ==  'JavaStaticText' || e_targettype ==  'SwfEdit' || e_targettype ==  'TeField' || e_targettype ==  'WebElement')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify the text " + step_data + " in the " + target + " field";
		}
		else if(e_targettype == 'WebList' || e_targettype ==  'JavaList' || e_targettype ==  'SwfList')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify the text " + step_data + " in the " + target + " list";
		}
		else if (e_targettype == 'SAPGuiWindow')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify the text $data in the " + target + " page";
		}
	}
	else if(e_action == 'VerifyTextfromXY' && e_targettype == 'TeScreen'){
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Verify the text is available at given co-ordinates in the " + target + " screen";
	}
	else if(e_action == 'VerifyWindow'){
	  if(e_targettype == 'SwfWindow'){	
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Verify whether " + target + " window is displayed";
	  }
	  else if(e_targettype == 'OracleFlexWindow' || e_targettype == 'OracleFormWindow'){
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Verify whether " +target+ " window is displayed with $data title";
	  }	
	}
	else if(e_action == 'VerifyOption'){
          if(e_targettype == 'OracleList ' || e_targettype == 'OracleListOfValues' || e_targettype == 'OraclePicklist' || e_targettype == 'OracleTree'){
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify whether $data is present in " + target;
		  }
	}
	else if(e_action == 'Wait' && e_targettype == 'Page'){
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Wait for the " + target + " page";
	} else if(e_action == 'Hover'){
		if(e_targettype == 'Image')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Hover on  " + target + " image";
		}
		else if(e_targettype == 'WebButton')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Hover on  " + target + " button";
		}
		else if(e_targettype == 'Link')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Hover on  " + target + " tab";
		}		
		else if(e_targettype == 'WebElement')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Hover on  " + target + " Link";
		}
		else if(e_targettype == 'Tab')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Hover on  " + target + " button";
		}
		else if(e_targettype == 'MenuItem')
		{
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Hover on  " + target + " Tab";
		}
	
	}
	else if(e_action == 'IsEnabled'){
		  if(e_targettype == 'OracleButton' || e_targettype == 'OracleCalendar' || e_targettype == 'OracleCheckbox' 
			|| e_targettype == 'OracleList' || e_targettype == 'OracleListOfValues' || e_targettype =='OracleNotification' 
			|| e_targettype == 'OraclePicklist' || e_targettype == 'OracleRadioGroup' || e_targettype == 'OracleTabbedRegion' 
		    || e_targettype == 'OracleTable' || e_targettype == 'OracleTextField' || e_targettype == 'OracleTree'){
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Verify  " + target + " is enabled";
		  }
    		  
	}
	else if(e_action == 'IsDisabled'){
		if(e_targettype == 'OracleButton' || e_targettype == 'OracleCalendar' || e_targettype == 'OracleCheckbox' 
		|| e_targettype == 'OracleList' || e_targettype == 'OracleListOfValues' || e_targettype =='OracleNotification' 
		|| e_targettype == 'OraclePicklist' || e_targettype == 'OracleRadioGroup' || e_targettype == 'OracleTabbedRegion' 
		|| e_targettype == 'OracleTable' || e_targettype == 'OracleTextField' || e_targettype == 'OracleTree'){
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Verify  " + target + " is disabled";
	  }

	}
	else if(e_action == 'Approve'){
		if(e_targettype == 'OracleNotification' || e_targettype =='OracleFlexWindow'){
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Approve  " + target + " notification";
		}

	}
    else if(e_action == 'Decline'){
		if(e_targettype == 'OracleNotification'){
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "Decline " + target + " notification";
		}
	}	
   else if(e_action == 'SetCellData'){
	   if(e_targettype == 'OracleTable'){
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Find cell $rownumber, $ColumnName and set $data for " + target + " table";
	   }
   }
  else if(e_action == 'GetCellData'){
	if(e_targettype == 'OracleTable'){
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Get celldata of $row,$col from " + target;
	   }
  }  	
  else if(e_action == 'Deselect'){
	if(e_targettype == 'OraclePicklist'){
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Deselect #data# from  "  +target+ " picklist";
	   }
  }
  
  else if(e_action == 'IsChecked'){
	if(e_targettype == 'OracleCheckbox'){
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Check whether " +target+ " checkbox is selected or not";
	   }
	 else if(e_targettype == 'OracleRadioGroup'){
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Check whether " +target+ " radiogroup is selected or not";
	 }  
  }  
  else if(e_action == 'SelectContextMenuItem'){
	  if(e_targettype =='OracleApplications' || e_targettype  == 'OracleButton' || e_targettype == 'OracleCalendar'
		|| e_targettype == 'OracleCheckbox' || e_targettype == 'OracleFlexWindow' || e_targettype == "OracleFormWindow"
		|| e_targettype == 'OracleList' || e_targettype == 'OracleListOfValues' || e_targettype == 'OracleLogon'
		|| e_targettype == 'OracleNavigator' || e_targettype == 'OracleNotification' || e_targettype == 'OraclePicklist'
		|| e_targettype == 'OracleRadioGroup' || e_targettype == 'OracleStatusLine' || e_targettype == 'OracleTabbedRegion'
		|| e_targettype == 'OracleTable' || e_targettype == 'OracleTextField' || e_targettype == 'OracleTree' ){
			var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
			autoPopItem.innerHTML = "";
			autoPopItem.innerHTML = "SelectContextMenuItem $data for " +target;
	  }
  }
  else if(e_action == 'SelectFunction'){
	  if(e_targettype == 'OracleNavigator'){
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "SelectFunction $data for " +target;
	  }
  } 

  else if (e_action == 'OpenDialog'){
	  if(e_targettype == 'OracleTable'){
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Opens a specified record field's associated dialog box for " +target+ " using  $recordNo and $col";
	  }
	 else if(e_targettype == 'OracleTextField'){
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Opens the field's associated dialog box for " +target;
	 }  
  }
  else if (e_action == 'PressToolbarButton'){
	  if(e_targettype == 'OracleFormWindow' || e_targettype == 'OracleLogon' || e_targettype == 'OracleNavigator'){
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Presses a $button toolbar button for " +target; 
	  }
  } 
 else if (e_action == 'RefreshObject'){
	 if(e_targettype == 'OracleApplications' || e_targettype == 'OracleButton' || e_targettype == 'OracleCalendar'
		|| e_targettype == 'OracleCheckbox' || e_targettype == 'OracleFlexWindow' || e_targettype == 'OracleFormWindow'
		|| e_targettype == 'OracleList' || e_targettype == 'OracleListOfValues' || e_targettype == 'OracleLogon'
		|| e_targettype == 'OracleNavigator' || e_targettype == 'OracleNotification' || e_targettype =='OraclePicklist'
		|| e_targettype == 'OracleRadioGroup' || e_targettype == 'OracleStatusLine' || e_targettype == 'OracleTabbedRegion'
	    || e_targettype == 'OracleTable' || e_targettype == 'OracleTextField' || e_targettype == 'OracleTree'){
		var autoPopItem = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
		autoPopItem.innerHTML = "";
		autoPopItem.innerHTML = "Refesh " + target + " object"; 
	 }
 } 	
};

/*
var deleteRow = function(tableID) {
	var tableOuter = document.getElementById(tableID); 
	var rowTableOuter = tableOuter.rows;
//alert(rowCount);
        $(rowTableOuter).each(function (i) {
			var table = document.getElementById(tableID);
			var rowCount = table.rows.length;
            if ($(this).find('input[type="checkbox"]').is(':checked') && rowCount >2) {
                $(this).closest('tr').remove();
            }else if($(this).find('input[type="checkbox"]').is(':checked') && rowCount ==2) {
				if(tableID == 'dataTable'){
					addRow(tableID);
					table.deleteRow(1);
				}else if(tableID == 'testDataTable'){
					addRowData(tableID);
					table.deleteRow(1);	
				}
				//$(this).closest('tr').remove(); vinodin
            }
		/*	else if(rowCount == 2){alert(rowCount);
				alert('You cannot Delete First Row');
			}*/
/*        });
        AutoNumber(tableID);
		}
*/		
/*		
function AutoNumber(tableID){
    $('#tableID tr').each(function (i) {
    $(this).find('span').text(i);
    });
}		
*/
//validateStepDel('dataTable');
function validateStepDel(tableID) {
	var boolChkClick = false;
	var table = document.getElementById(tableID); 
	var rowCount = table.rows.length;
	for(var i=0; i<rowCount; i++) {
		var row = table.rows[i];
		var chkbox = row.cells[0].childNodes[0];
		if(null != chkbox && true == chkbox.checked){
			deleteRow('dataTable');
			boolChkClick = true;
			break;
		}				
	}
	if(boolChkClick == false){
		dailogmsg(labelObj.deleteMsg);
	}
}
//validateDataDel('testDataTable');
function validateDataDel(tableID) {
	var boolChkClick = false;
	var table = document.getElementById(tableID); 
	var rowCount = table.rows.length;
	for(var i=0; i<rowCount; i++) {
		var row = table.rows[i];
		var chkbox = row.cells[0].childNodes[0];
		if(null != chkbox && true == chkbox.checked){
			deleteRowData('testDataTable');
			boolChkClick = true;
			break;
		}				
	}
	if(boolChkClick == false){
        dailogmsg(labelObj.deleteMsg);
	}
}
var deleteRow = function(tableID) {
	
        var table = document.getElementById(tableID); 
        var rowCount = table.rows.length;
		var delStepJSON=new Array();
		
		for(var i=1; i<rowCount; i++) {
		var row = table.rows[i];
		var chkbox = row.cells[0].childNodes[0];
		if(null != chkbox && true == chkbox.checked) {
			var testStepId = row.getElementsByTagName("label")[3].innerHTML;
			var dataJSON = {checkStepId:testStepId};
            delStepJSON.push(dataJSON);
			}				
		}
		var data = {fileAdd:"TCR",stepId:delStepJSON};
		sendAJAX(data,app_server_url,function(data){
		if(data["code"] == '200'){
			//alert("Saved successfully");
			console.log("Saved Test Steps successfully");
		}else{
            dailogmsg(data["msg"]);
		}
	});
	//setTimeout(function(){deleteRowDataCallFrmTstStp('testDataTable');}, 30);	// this is to delay the call as quick call was sometimes didn't invoke deleteRowDataCallFrmTstStp()
	setTimeout(function(){renderTestCondition(cellView);}, 30);	// this is to delay the call as quick call was sometimes didn't invoke renderTestCondition()
	
}


var deleteRowData = function(tableID) {
	
        var table = document.getElementById(tableID); 
        var rowCount = table.rows.length;
		var delDataJSON=new Array();
		
		for(var i=1; i<rowCount; i++) {
		var row = table.rows[i];
		var chkbox = row.cells[0].childNodes[0];
		if(null != chkbox && true == chkbox.checked) {
			var testDataId = row.getElementsByTagName("label")[2].innerHTML;
			var dataJSON = {checkDataId:testDataId};
            delDataJSON.push(dataJSON);
			}				
		}
		var data = {fileAdd:"TDR",dataId:delDataJSON};
		sendAJAX(data,app_server_url,function(data){
		if(data["code"] == '200'){
			//alert("Saved successfully");
			console.log("Saved Test Steps successfully");
		}else{
            dailogmsg(data["msg"]);
		}
	});
	setTimeout(function(){autoPopulateLabelData(testStepRowClicked);}, 30);	// this is to delay the call as quick call was sometimes didn't invoke autoPopulateLabelData()
		//autoPopulateLabelData(testStepRowClicked);
		//renderTestCondition(cellView);
}

/*
var deleteRow = function(tableID) {
			try {
			var table = document.getElementById(tableID);
			var rowCount = table.rows.length;

			for(var i=0; i<rowCount; i++) {
				var row = table.rows[i];
				var chkbox = row.cells[0].childNodes[0];
				if(null != chkbox && true == chkbox.checked) {
					if(rowCount <= 1) {
						alert("Cannot delete all the rows.");
						break;
					}
					table.deleteRow(i);
					rowCount--;
					i--;
				}


			}
			}catch(e) {
				alert(e);
			}
		}
*/
		
var deleteFirstRow = function(tableID) {
	var table = document.getElementById(tableID);
	var rowCount = table.rows.length;
	if(rowCount > 2){
		table.deleteRow(1);
	}
}

//function actionConmbo(){	

    for (var keys in jsonObj) {              
        category_dropdown[category_dropdown.length] = new Option(keys,keys);  
    }   
	
//}

	
	$(document).ready(function(){
	$("#TestConditions").click(function(){		
		if(nodeSelectedFlag == false){
            ///dailogmsg("Please Select a Node");
			//$("#tes_cond").css("display","none");
			renderTestCondition();
		}

	});
	});
	
function renderTestCondition(cellModelObj){	
	testCondCurrentSelectedNode = currentSelectedNode;
	testCondVersion_id = (currentSelectedNode.id).split("_")[1];
	$("#tes_data_action").html("");	
	$("[id=tes-cond-chk-all]").prop('checked', false);
	$("#testDataTable input[name=Selectall]").prop('checked', false);		
	nodeSelectedFlag = true;
	openBottomToolbar();
	$("a[data-prop='tes_cond']").click();
	$("#tes_cond").css("display","block");
	$("#import_excel").val('');
	$("#import_excel_data").val('');
	if(cellModelObj!=undefined){
		cellView = cellModelObj;
		node_id = cellModelObj.id;
		var n = node_id;
		data = {fileAdd:"GTD",vId:testCondVersion_id};
		sendAJAX(data,app_server_url,function(data){
			if(data["code"] == '200'){
				tool_id=data.data.toolId;
				var toolName=data.data.toolName;
				tool_type=data.data.toolTyp;				
				data = {fileAdd:"TCA",n:node_id,testCondVersion_id:testCondVersion_id,tool_id:tool_id};
				if (toolName=='OpenTest'){
					data['actTyp']=tool_type;
				}
				sendAJAX(data,app_server_url,function(data){
					if(data["code"] == '200'){
						if(toolName==null || toolName=='CafeNext'){
							$("#cafenext_wrapper").show();
							$("#opentest_wrapper").hide();
							testCondDB=data.data.testData;
							var tableLength = testCondDB.length;
							cleanTable('dataTable');
							cleanDataTable('testDataTable');			
							$("#delete_row").prop("disabled", true); 
							if(tableLength > 0){
								$.each(testCondDB, function (index, each_row) {
									//addRowDB('dataTable',testCondDB[index], index+1, tableLength);      				          
									addRowDB('dataTable',testCondDB[index], tableLength);
									$("#delete_row").prop("disabled", false); 				
								});
								$('#display_msg_test_step').hide();
								$('#dataTable').show();
								$('#save_test_cond').prop( "disabled", false);
							}else{
								$('#dataTable').hide();
								$('#display_msg_test_step').show();
								$('#save_test_cond').prop( "disabled", true);
								$('#testDataTable').hide(); 
								$('#display_msg_test_data').show();
								$('#save_test_data').prop( "disabled", true );
							}   
						}else if (toolName=='OpenTest'){
							$("#cafenext_wrapper").hide();
							$("#opentest_wrapper").show();
							$('#opentest_wrapper table#ot_data_table').empty();
							populateKeywordData(tool_type,'CREATE',data.data.testData);
						}
					}else{
						dailogmsg(data["msg"]);
					}		
				});		
			}
			});
		}else{
			cleanTable('dataTable');
			cleanDataTable('testDataTable');
		}
	testStepIdGlobal = '';
	testStepRowClicked = '';	
	nodeSelectedFlag = false;
}

var cleanTable = function(tableID) {
	try {
		var table = document.getElementById(tableID);
		var rowCount = table.rows.length;
		//alert(rowCount);
		//var diff = (rowCount - tableLength)+1;
		$("#tes_cond_target").prop("disabled", true); 
        $("#tes_cond_step_data").prop("disabled", true);
	if(rowCount <= 2){				
		addRow('dataTable');
		table.deleteRow(1);
		AutoNumber('dataTable');
	}else{
		for(var i=1; i<rowCount-1; i++) {
			table.deleteRow(rowCount-i);				
		}
		addRow('dataTable');
		table.deleteRow(1);
		AutoNumber('dataTable');
	}
	}catch(e) {
		dailogmsg(e);
	}
}

var addRowDB = function(tableID, testCondDB, tableLength) {
	action = '';
	target_type = '';
	target = '#target#';
	step_data = '$data';
	
        var table = document.getElementById(tableID); 
        var rowCount = table.rows.length;
        var row = table.insertRow(rowCount);
        var colCount = table.rows[0].cells.length;
       for (var i = 0; i<colCount; i++) {
             var newcell = row.insertCell(i);
             newcell.innerHTML = table.rows[1].cells[i].innerHTML;
             //newcell.childNodes[0].selectedIndex = 0;
			 var element;
			 if(i==2){
				element = (row != null ? row.getElementsByTagName("select")[0] : document.getElementById("tes_cond_action"));
				element.value = testCondDB.action;
				action = testCondDB.action;				
			 }     
			 if(i==3){
				var targetTypeDb = testCondDB.target_type;
				if(targetTypeDb==0){
					var currElementTargetType = (row != null ? row.getElementsByTagName("select")[1] : document.getElementById("tes_cond_targettype"));
					$(currElementTargetType).empty();
					//$(currElementTargetType).prepend('<option selected="selected" value="Select Target Type">Select Target Type</option>');
					//Fix for Bug, when user import excel and then if click add button or multiple click on add button was throwing error
					$(currElementTargetType).prepend('<option selected="selected" value="0">'+labelObj.selectTargetType+'</option>');
				}
				else{
					getSelectedItemDB(element, row);
					var elementTargetType = (row != null ? row.getElementsByTagName("select")[1] : document.getElementById("tes_cond_targettype"));
					elementTargetType.value = testCondDB.target_type;
					target_type = testCondDB.target_type;
				}
			 }   
			 if(i==4){
				var elementTargetTxt = (row != null ? row.getElementsByTagName("input")[1] : document.getElementById("tes_cond_target"));
				elementTargetTxt.value = testCondDB.target;
			 } 		
			 if(i==5){
				var elementTargetStpData = (row != null ? row.getElementsByTagName("input")[2] : document.getElementById("tes_cond_step_data"));
				elementTargetStpData.value = testCondDB.tst_step_data;
			 } 
			 if(i==6){	
				var elementDesc = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
				elementDesc.innerHTML = testCondDB.description;
				//elementDesc.innerHTML = "test";
			 } 
			 if(i==8){	
				var elementId = (row != null ? row.getElementsByTagName("label")[3] : document.getElementById("tes_cond_stepId"));
				elementId.innerHTML = testCondDB.id;
				//elementDesc.innerHTML = "test";
			 } 			 
    }
	if(rowCount > tableLength){
			table.deleteRow(1);
			AutoNumber('dataTable');
		}
    var selects = row.getElementsByTagName("select");
	var texts = row.getElementsByTagName("input");
	var labels = row.getElementsByTagName("label");
	//autoPopulateItemBlank(this, row);
    selects[0].addEventListener('change', function() { getSelectedItem(this, row) }, false);
	selects[1].addEventListener('change', function() { autoPopulateItemTarget_Type(this, row) }, false);
	texts[1].addEventListener('change', function() { autoPopulateItemTarget(this, row) }, false);
	texts[2].addEventListener('change', function() { autoPopulateItemStepData(this, row) }, false);
	labels[2].addEventListener('click', function() { autoPopulateLabelData(row) }, false);
	//AutoNumber();
};

var getSelectedItemDB = function(element, row) {
    var e = element;
    var selectedCategory = e.options[e.selectedIndex].value;
    var sub_category_dropdown = (row != null ? row.getElementsByTagName("select")[1] : document.getElementById("tes_cond_targettype"));
    sub_category_dropdown.options.length=0;
    for (var i=0;i<jsonObj[selectedCategory].length;i++) {
        sub_category_dropdown[sub_category_dropdown.length] = new Option(jsonObj[selectedCategory][i],jsonObj[selectedCategory][i]);
    }	
};

var removeExistingDB = function(node_id) {
	var nodid = node_id;
	var data = {fileAdd:"TCR",nodid:node_id};
	sendAJAX(data,app_server_url,function(data){
		if(data["code"] == '200'){
            dailogmsg("Removed successfully");
			//refreshScenariosData(modelVersionId);
		}else{
            dailogmsg(data["msg"]);
		}
	});
};

function insert_test_cond(row) {		
        var table = document.getElementById("dataTable"); 
        var rowCount = table.rows.length;
		//var del = 'true'
		//removeExistingDB(node_id);
		//var delOldData = 0;
		var testStepJSON=new Array();
		for(var i=rowCount; i==rowCount ; i++){
			
			var row = table.rows[i-1];
			var testStepNo = row.getElementsByTagName("label")[0].innerText;
			var action = row.getElementsByTagName("select")[0].value;
			var targetType = row.getElementsByTagName("select")[1].value;
			var testCondTarget = row.getElementsByTagName("input")[1].value;
			var testCondStepData = row.getElementsByTagName("input")[2].value;
			var nodeid = node_id;
			var testDescription = row.getElementsByTagName("label")[1].innerText;
			//alert(action + targetType + testCondTarget + testCondStepData);
			
			//var data = {fileAdd:"TCR",nodeid:node_id};
			
			var dataJSON = {testStepNo:testStepNo,action:action,targetType:targetType,testCondTarget:testCondTarget,testCondStepData:testCondStepData,nodeid:node_id,testDescription:testDescription,testCondVersion_id:testCondVersion_id};
			
            testStepJSON.push(dataJSON);
			
			 //var step_data = {fileAdd:"TCD",testCondStepData:testCondStepData};
			 }
			  var data = {fileAdd:"TCO",teststep:testStepJSON};
				sendAJAX(data,app_server_url,function(data){
					
					if(data["code"] == '200'){
						//alert("Saved successfully");
						console.log("Saved Test Steps successfully");
					}else{
                        dailogmsg(data["msg"]);
					}
				});
    };
	
	
$("#save_test_cond").click(function(){
	
        var table = document.getElementById("dataTable"); 
        var rowCount = table.rows.length;
		var testStepJSON=new Array();
		for(var i=1; i<rowCount ; i++){
			
			var row = table.rows[i];
			var testStepNo = row.getElementsByTagName("label")[0].innerText;
			var action = row.getElementsByTagName("select")[0].value;
			var targetType = row.getElementsByTagName("select")[1].value;
			var testCondTarget = row.getElementsByTagName("input")[1].value;
			var testCondStepData = row.getElementsByTagName("input")[2].value;
			var nodeid = node_id;
			var testDescription = row.getElementsByTagName("label")[1].innerText;
			var testStepId = row.getElementsByTagName("label")[3].innerHTML;
			var dataJSON = {testStepNo:testStepNo,action:action,targetType:targetType,testCondTarget:testCondTarget,testCondStepData:testCondStepData,nodeid:node_id,testDescription:testDescription,testCondVersion_id:testCondVersion_id,testStepId:testStepId};
			
            testStepJSON.push(dataJSON);
			}
			  var data = {fileAdd:"TCU",teststep:testStepJSON};
				sendAJAX(data,app_server_url,function(data){
					
					if(data["code"] == '200'){
						//alert("Saved successfully");
						console.log("Saved Test Steps successfully");
					}else{
                        dailogmsg(data["msg"]);
					}
				});
	if(callFromAddStepTable == false){
        dailogmsg(labelObj.savedMsg);
	}else{
		callFromAddStepTable = false;
	}
    });	


	
// Import to Excel

var addRowExcel = function(tableID, rowExcl, tableLength) {
	action = '';
	target_type = '';
	target = '#target#';
	step_data = '$data';
        var table = document.getElementById(tableID); 
        var rowCount = table.rows.length;
        var row = table.insertRow(rowCount);
        var colCount = table.rows[0].cells.length;
		if(rowCount > tableLength){
			for(var i =1; i<=rowCount-tableLength; i++){
				table.deleteRow(i);
				AutoNumber('dataTable');
			}
		}
       for (var i = 0; i<colCount; i++) {
            var newcell = row.insertCell(i);
            newcell.innerHTML = table.rows[1].cells[i].innerHTML;
             //newcell.childNodes[0].selectedIndex = 0;
			 var element;
			 var elementTargetType;
			 var elementTargetTxt;
			 var elementTargetStpData;
			 if(i==2){
				element = (row != null ? row.getElementsByTagName("select")[0] : document.getElementById("tes_cond_action"));
				element.value = rowExcl.getCellText(1);
				action = rowExcl.getCellText(1);
			 }     
			 if(i==3){
				getSelectedItemDB(element, row);
				elementTargetType = (row != null ? row.getElementsByTagName("select")[1] : document.getElementById("tes_cond_targettype"));
				elementTargetType.value = rowExcl.getCellText(2);
				target_type = rowExcl.getCellText(2);
			 }   
			 if(i==4){
				elementTargetTxt = (row != null ? row.getElementsByTagName("input")[1] : document.getElementById("tes_cond_target"));
				elementTargetTxt.value = rowExcl.getCellText(3);
				target = elementTargetTxt.value; // fix for autoDescription while importing excel
			 } 		
			 if(i==5){
				elementTargetStpData = (row != null ? row.getElementsByTagName("input")[2] : document.getElementById("tes_cond_step_data"));
				elementTargetStpData.value = rowExcl.getCellText(4);
				step_data = elementTargetStpData.value; // fix for autoDescription while importing excel
			 } 
			 if(i==6){	
				var elementDesc = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_cond_description"));
				//elementDesc.innerHTML = rowExcl.getCellText(5);
				elementDesc.innerHTML = "";
				autoDescription(action, target_type, row);
			 } 			 
    }
    var selects = row.getElementsByTagName("select");
	var texts = row.getElementsByTagName("input");
	var labels = row.getElementsByTagName("label");
	//autoPopulateItemBlank(this, row);
    selects[0].addEventListener('change', function() { getSelectedItem(this, row) }, false);
	selects[1].addEventListener('change', function() { autoPopulateItemTarget_Type(this, row) }, false);
	texts[1].addEventListener('change', function() { autoPopulateItemTarget(this, row) }, false);
	texts[2].addEventListener('change', function() { autoPopulateItemStepData(this, row) }, false);
	labels[2].addEventListener('click', function() { autoPopulateLabelData(row) }, false);
	AutoNumber('dataTable');
	$('#display_msg_test_step').hide();
	$('#dataTable').show();
	$('#save_test_cond').prop( "disabled", false );
};

$(function () {

	$("#import_excel").on("change", function () {
		var excelFile,
			fileReader = new FileReader();

		$("#result").hide();

		fileReader.onload = function (e) {
			var buffer = new Uint8Array(fileReader.result);

			$.ig.excel.Workbook.load(buffer, function (workbook) {
				var column, row, newRow, cellValue, columnIndex, i,
					worksheet = workbook.worksheets(0),
					columnsNumber = 0,
					gridColumns = [],
					data = [],
					worksheetRowsCount;

				// Both the columns and rows in the worksheet are lazily created and because of this most of the time worksheet.columns().count() will return 0
				// So to get the number of columns we read the values in the first row and count. When value is null we stop counting columns:
				while (worksheet.rows(0).getCellValue(columnsNumber)) {
					columnsNumber++;
				}

				// Iterating through cells in first row and use the cell text as key and header text for the grid columns
				for (columnIndex = 0; columnIndex < columnsNumber; columnIndex++) {
					column = worksheet.rows(0).getCellText(columnIndex);
					gridColumns.push({ headerText: "", key: column });
				}

				// We start iterating from 1, because we already read the first row to build the gridColumns array above
				// We use each cell value and add it to json array, which will be used as dataSource for the grid
				cleanTable('dataTable');
				for (i = 1, worksheetRowsCount = worksheet.rows().count() ; i < worksheetRowsCount; i++) {
					newRow = {};
					row = worksheet.rows(i);
					var totalRows = worksheet.rows().count();
					var actionExcel = row.getCellText(1);
					if(actionExcel != ''){
						addRowExcel('dataTable',row, worksheet.rows().count());
					}else{
						//addRow('dataTable');
						break;
					}
				}
				deleteFirstRow('dataTable');
				//cleanTable('dataTable');
				AutoNumber('dataTable');
				saveExcelIntoDb('dataTable');
				//setTimeout(function(){saveExcelIntoDb('dataTable');}, 10);	// this is to delay the call as quick call was sometimes didn't invoke saveExcelIntoDb()
				setTimeout(function(){renderTestCondition(cellView);}, 500);	// this is to delay the call as quick call was sometimes didn't invoke renderTestCondition()
			}, function (error) {
				$("#result").text("The excel file is corrupted.");
				$("#result").show(1000);
			});
		}

		if (this.files.length > 0) {
			excelFile = this.files[0];//alert(excelFile.name);
		/*	if ((excelFile.type === "application/vnd.ms-excel" || excelFile.type === "application/vnd.ms-excel.sheet.macroEnabled.12" || excelFile.type === "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" || (excelFile.type === "" && (excelFile.name.endsWith("xls") || excelFile.name.endsWith("xlsx")))) &&excelFile.name == "ExcelTemplate_TestCond.xlsm" ) { */
		if (excelFile.type === "application/vnd.ms-excel.sheet.macroEnabled.12"){
				fileReader.readAsArrayBuffer(excelFile);
			} else {
				dailogmsg("Please import ExcelTemplate_TestCond.xlsm");
				$("#result").text("The format of the file you have selected is not supported. Please select a valid Excel file ('.xls, *.xlsx').");
				$("#result").show(1000);
			}
		}
		//$("#import_excel").val('');

	})
});


//Code for table Test Data


//dynamic table used for Test Data
 var addRowData = function(tableID) {
	
        var table = document.getElementById(tableID); 
        var rowCount = table.rows.length;
        var row = table.insertRow(rowCount);
        var colCount = table.rows[0].cells.length;

       for (var i = 0; i<colCount; i++) {
             var newcell = row.insertCell(i);
             newcell.innerHTML = table.rows[1].cells[i].innerHTML;
             //newcell.childNodes[0].selectedIndex = 0;
    } 
    AutoNumber('testDataTable');
}; 

 var addRowDataSaveDb = function(tableID) {
//	 callFromAddDataTable = true;
	if($('#testDataTable').is(':visible')){
		callFromAddDataTable = true; // Fix for Bug, when there was no(or delete all rows) rows in TestData 
									//	and then if user add a row and then if click save the 'Save Successfully' message was not displayed
		$("#save_test_data").click();
	}
	 
//	 if(valueInTestDataDb == false){
//		 }
	
	
	 if(testStepIdGlobal != '' && testStepRowClicked != ''){
		var table = document.getElementById(tableID); 
		var rowCount = table.rows.length;
		var row = table.insertRow(rowCount);
		var colCount = table.rows[0].cells.length;
		for (var i = 0; i<colCount; i++) {
			var newcell = row.insertCell(i);
			newcell.innerHTML = table.rows[1].cells[i].innerHTML;
			//newcell.childNodes[0].selectedIndex = 0;
		} 
		AutoNumber('testDataTable');
		insert_test_data(row);
		//alert("called TDA");	
		setTimeout(function(){ 
			autoPopulateLabelData(testStepRowClicked);
			$('#display_msg_test_data').hide();
			$('#save_test_data').prop( "disabled", false );
			$('#testDataTable').show(); 
			}, 300);	//this is to delay the call as the autoPopulate call were not invoked intermittently
		//autoPopulateLabelData(testStepRowClicked);		
		
	 }else{
         dailogmsg("Please Select A Test Step By Clicking Over Arrow In AddData")
	 }
}; 

function insert_test_data(row) {	
	var table = document.getElementById("testDataTable"); 
	var rowCount = table.rows.length;
	var testDataJSON=new Array();
	for(var i=rowCount; i==rowCount ; i++){		
		var row = table.rows[i-1];	
		var testData = row.getElementsByTagName("input")[1].value;
		//var testDataId = row.getElementsByTagName("label")[2].innerHTML;
		var dataJSON = {testData:testData,testStepIdGlobal:testStepIdGlobal};
		testDataJSON.push(dataJSON);	
}
		var data = {fileAdd:"TDO",testdata:testDataJSON};
		sendAJAX(data,app_server_url,function(data){
		if(data["code"] == '200'){
			//alert("Saved successfully");
			console.log("Saved Test Data successfully");
			}else{
            dailogmsg(data["msg"]);
		}
	});
	//alert("Saved successfully");

    };

	
	
$("#save_test_data").click(function(){
	
	var table = document.getElementById("testDataTable"); 
	var rowCount = table.rows.length;
	var testDataJSON=new Array();
	for(var i=1; i<rowCount ; i++){
		
		var row = table.rows[i];
		var testData = row.getElementsByTagName("input")[1].value;
		var testDataId = row.getElementsByTagName("label")[2].innerHTML;
		var dataJSON = {testData:testData,testStepIdGlobal:testStepIdGlobal,testDataId:testDataId};
		testDataJSON.push(dataJSON);	
}
		var data = {fileAdd:"TDU",testdata:testDataJSON};
		sendAJAX(data,app_server_url,function(data){
		if(data["code"] == '200'){
			//alert("Saved successfully");
			console.log("Saved Test Data successfully");
			}else{
            dailogmsg(data["msg"]);
		}
	});
	if(callFromAddDataTable == false){
        dailogmsg("Saved successfully");
	}else{
		callFromAddDataTable = false;
	}

    });




function autoPopulateLabelData(row) {
      $("#dataTable tr").css("background","#F5F5F5");
		var index = row.rowindex;
	    row.style.background="#d6d6d6";
	
	var autoPopIcon = (row != null ? row.getElementsByTagName("label")[2] : document.getElementById("action_data"));
	//autoPopIcon.css("background-color","green");
	//autoPopIcon.innerHTML = "Data";
	
	testStepRowClicked = row;
	var currDataAction = (row != null ? row.getElementsByTagName("select")[0] : document.getElementById("tes_cond_action"));
	var currDataTargetType = (row != null ? row.getElementsByTagName("select")[1] : document.getElementById("tes_cond_targettype"));
	var currDataTargetText = (row != null ? row.getElementsByTagName("input")[1] : document.getElementById("tes_cond_target"));
	testStepIdGlobal = row.getElementsByTagName("label")[3].innerHTML;
	// Code to Populate Target
	$("#tes_data_action").html(currDataAction.value + '->' + currDataTargetType.value + '->' + currDataTargetText.value);		
	actionTestData = currDataAction.value;
	targetTypeTestData = currDataTargetType.value;
	targetTestData = currDataTargetText.value;

	
	//Code for testDataTable to enable and invoke
	
	//node_id = cellModelObj.id;
	var n = node_id;
	if(testStepIdGlobal != ""){
		data = {fileAdd:"TDA",testStepId:testStepIdGlobal};
		sendAJAX(data,app_server_url,function(data){
		if(data["code"] == '200'){
			console.log("Refreshed scenarios data successfully");
			testDataDB=data.data;
			var tableLength = testDataDB.length;
			//alert(tableLength);
			cleanDataTable('testDataTable');
			if(tableLength > 0){				
				$.each(testDataDB, function (index, each_row) {
				//addRowDB('testDataTable',testDataDB[index], index+1, tableLength);      				          
				addRowDataDB('testDataTable',testDataDB[index], tableLength);      				          
				});	
				AutoNumber('testDataTable');
				$('#display_msg_test_data').hide();
				$('#save_test_data').prop( "disabled", false );
				$('#testDataTable').show();
			}else{
				$('#testDataTable').hide();
				$('#display_msg_test_data').show();
				$('#save_test_data').prop( "disabled", true );
			}
		}else{
            dailogmsg(data["msg"]);
		}
		});	
	}
	$('#save_test_data').prop( "disabled", false );
	$('#add_row_data').prop( "disabled", false );
	$('#delete_row_data').prop( "disabled", false );	
	$('#tes_data').prop( "disabled", false );
	//code chnages ends
	
	//Code to change icon of Add Data to text and vice-versa
/*	$( "i" ).remove(":contains(' ')");
	var icon = document.createElement("i");
    icon.className ="fa fa-eyedropper";
    autoPopItem.appendChild(icon);	*/
	
	//Ends
	
};

var cleanDataTable = function(tableID) {
	try {
		var table = document.getElementById(tableID);
		var rowCount = table.rows.length;
/*
	var table = document.getElementById(tableID); 
	var rowTable = table.rows;
	$(rowTable).each(function (i) {
		$(this).find('span').text(i);
	});
*/
	if(rowCount <= 2){			
		addRowData('testDataTable');
		table.deleteRow(1);	
		AutoNumber('testDataTable');
	}else{
		for(var i=1; i<rowCount-1; i++) {
			table.deleteRow(rowCount-i);
			AutoNumber('testDataTable');			
		}
		addRowData('testDataTable');
		table.deleteRow(1);
		AutoNumber('testDataTable');
	}
	}catch(e) {
        dailogmsg(e);
	}
}

var addRowDataDB = function(tableID, testDataDB, tableLength) {
//	action = '';
//	target_type = '';
//	target = '#target#';
//	step_data = '$data';
	
        var table = document.getElementById(tableID); 
        var rowCount = table.rows.length;
        var row = table.insertRow(rowCount);
        var colCount = table.rows[0].cells.length;
       for (var i = 0; i<colCount; i++) {
             var newcell = row.insertCell(i);
             newcell.innerHTML = table.rows[1].cells[i].innerHTML;
             //newcell.childNodes[0].selectedIndex = 0;
			 //var element;
			 if(i==2){
				var currDataAction = (testStepRowClicked != null ? testStepRowClicked.getElementsByTagName("select")[0] : document.getElementById("tes_cond_action"));
				var currDataTargetType = (testStepRowClicked != null ? testStepRowClicked.getElementsByTagName("select")[1] : document.getElementById("tes_cond_targettype"));
				var currDataTargetText = (testStepRowClicked != null ? testStepRowClicked.getElementsByTagName("input")[1] : document.getElementById("tes_cond_target"));
				$("#tes_data_action").html(currDataAction.value + '->' + currDataTargetType.value + '->' + currDataTargetText.value);
			 }     
			 if(i==3){
				var elementTargetTxt = (row != null ? row.getElementsByTagName("input")[1] : document.getElementById("tes_data"));
				elementTargetTxt.value = testDataDB.step_data;
			 }  
			 if(i==4){
				var elementId = (row != null ? row.getElementsByTagName("label")[2] : document.getElementById("tes_cond_dataId"));
				elementId.innerHTML = testDataDB.id;
			 }
    }
	if(rowCount > tableLength){
			table.deleteRow(1);
		}
};



//Importing test data Excel

$(function () {

	$("#import_excel_data").on("change", function () {
		var excelFile,
			fileReader = new FileReader();

		$("#result").hide();

		fileReader.onload = function (e) {
			var buffer = new Uint8Array(fileReader.result);

			$.ig.excel.Workbook.load(buffer, function (workbook) {
				var column, row, newRow, cellValue, columnIndex, i,
					worksheet = workbook.worksheets(0),
					columnsNumber = 0,
					gridColumns = [],
					data = [],
					worksheetRowsCount;

				// Both the columns and rows in the worksheet are lazily created and because of this most of the time worksheet.columns().count() will return 0
				// So to get the number of columns we read the values in the first row and count. When value is null we stop counting columns:
				while (worksheet.rows(0).getCellValue(columnsNumber)) {
					columnsNumber++;
				}

				// Iterating through cells in first row and use the cell text as key and header text for the grid columns
				for (columnIndex = 0; columnIndex < columnsNumber; columnIndex++) {
					column = worksheet.rows(0).getCellText(columnIndex);
					gridColumns.push({ headerText: "", key: column });
				}

				// We start iterating from 1, because we already read the first row to build the gridColumns array above
				// We use each cell value and add it to json array, which will be used as dataSource for the grid
				cleanDataTable('testDataTable');
				for (i = 1, worksheetRowsCount = worksheet.rows().count() ; i < worksheetRowsCount; i++) {
					newRow = {};
					row = worksheet.rows(i);
					var actionExcel = row.getCellText(1);
					if(actionExcel != ''){
						addRowDataExcel('testDataTable',row, worksheet.rows().count());  
					}else{
						break;
					}
				}
				deleteFirstRow('testDataTable');
				//cleanDataTable('testDataTable');
				AutoNumber('testDataTable');
				saveExcelTstDataInDb('testDataTable');
				setTimeout(function(){ 
				autoPopulateLabelData(testStepRowClicked);
				$('#display_msg_test_data').hide();
				$('#save_test_data').prop( "disabled", false );
				$('#testDataTable').show(); 
				}, 500);	//this is to delay the call as the autoPopulate call were not invoked intermittently
			//autoPopulateLabelData(testStepRowClicked);	
			}, function (error) {
				$("#result").text("The excel file is corrupted.");
				$("#result").show(1000);
			});
		}

		if (this.files.length > 0) {
			excelFile = this.files[0];
			//alert(excelFile.name);
			if(excelFile.name != 'ExcelTemplate_TestData.xlsx'){
                dailogmsg("Please Download ExcelTemplate_TestData.xlsx by clicking DownloadTemplate button and then try import");
			}else{
				if (excelFile.type === "application/vnd.ms-excel" || excelFile.type === "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" || (excelFile.type === "" && (excelFile.name.endsWith("xls") || excelFile.name.endsWith("xlsx")))) {
				fileReader.readAsArrayBuffer(excelFile);
			} else {
				$("#result").text("The format of the file you have selected is not supported. Please select a valid Excel file ('.xls, *.xlsx').");
				$("#result").show(1000);
			}
			}
		}
		$("#import_excel_data").val('');

	})
});


var addRowDataExcel = function(tableID, rowExcl, tableLength) {
        var table = document.getElementById(tableID); 
        var rowCount = table.rows.length;
        var row = table.insertRow(rowCount);
        var colCount = table.rows[0].cells.length;
		if(rowCount > tableLength){
			for(var i =1; i<=rowCount-tableLength; i++){
				table.deleteRow(i);
				AutoNumber('testDataTable');
			}
		}
       for (var i = 0; i<colCount; i++) {
            var newcell = row.insertCell(i);
            newcell.innerHTML = table.rows[1].cells[i].innerHTML;
			
 			 if(i==2){
				var elementTargetTxt = (row != null ? row.getElementsByTagName("label")[1] : document.getElementById("tes_data_action"));
				//alert(elementTargetTxt.innerHTML);
				if(elementTargetTxt.innerHTML == ""){
					cleanDataTable('testDataTable');
                    dailogmsg('Please Select Test Step');
					break;
				}
			 }	
			 if(i==3){
				var elementTargetLbl = (row != null ? row.getElementsByTagName("input")[1] : document.getElementById("tes_cond_target"));
				elementTargetLbl.value = rowExcl.getCellText(3);
			 }			 
    }
	AutoNumber('testDataTable');
	$('#display_msg_test_data').hide();
	$('#save_test_data').prop( "disabled", false );
	$('#testDataTable').show();	
};


function deleteRowDataCallFrmTstStp(tableID) {
        var table = document.getElementById(tableID); 
        var rowCount = table.rows.length;
		var delDataJSON=new Array();
		
		for(var i=0; i<rowCount; i++) {
		var row = table.rows[i];
			var testDataId = row.getElementsByTagName("label")[2].innerHTML;
			var dataJSON = {checkDataId:testDataId};
            delDataJSON.push(dataJSON);
		}
		var data = {fileAdd:"TDTCR",dataId:delDataJSON};
		sendAJAX(data,app_server_url,function(data){
		if(data["code"] == '200'){
			//alert("Saved successfully");
			console.log("Saved Test Steps successfully");
		}else{
            dailogmsg(data["msg"]);
		}
	});
	setTimeout(function(){autoPopulateLabelData(testStepRowClicked);}, 30);	// this is to delay the call as quick call was sometimes didn't invoke autoPopulateLabelData()
		//autoPopulateLabelData(testStepRowClicked);
		//renderTestCondition(cellView);
}


function saveExcelIntoDb(tableID) {
        var table = document.getElementById("dataTable"); 
        var rowCount = table.rows.length;
		//var del = 'true'
		//removeExistingDB(node_id);
		//var delOldData = 0;
		var testStepJSON=new Array();
		for(var i=1; i<rowCount ; i++){
			
			var row = table.rows[i];
			var testStepNo = row.getElementsByTagName("label")[0].innerText;
			var action = row.getElementsByTagName("select")[0].value;
			var targetType = row.getElementsByTagName("select")[1].value;
			var testCondTarget = row.getElementsByTagName("input")[1].value;
			var testCondStepData = row.getElementsByTagName("input")[2].value;
			var nodeid = node_id;
			var testDescription = row.getElementsByTagName("label")[1].innerText;
			//alert(action + targetType + testCondTarget + testCondStepData);
			
			//var data = {fileAdd:"TCR",nodeid:node_id};
			
			var dataJSON = {testStepNo:testStepNo,action:action,targetType:targetType,testCondTarget:testCondTarget,testCondStepData:testCondStepData,nodeid:node_id,testDescription:testDescription,testCondVersion_id:testCondVersion_id};
			
            testStepJSON.push(dataJSON);
			
			 //var step_data = {fileAdd:"TCD",testCondStepData:testCondStepData};
			 }
			  var data = {fileAdd:"TCO",teststep:testStepJSON};
				sendAJAX(data,app_server_url,function(data){
					
					if(data["code"] == '200'){
						//alert("Saved successfully");
						console.log("Saved Test Steps successfully");
					}else{
                        dailogmsg(data["msg"]);
					}
				});
	
	
	

	//alert("Saved successfully");

    }
	
function saveExcelTstDataInDb(tableID) {
	var table = document.getElementById("testDataTable"); 
	var rowCount = table.rows.length;
	var testDataJSON=new Array();
	for(var i=1; i<rowCount ; i++){
		var row = table.rows[i];
		var testData = row.getElementsByTagName("input")[1].value;
		var dataJSON = {testData:testData,testStepIdGlobal:testStepIdGlobal};
		testDataJSON.push(dataJSON);	
}
		var data = {fileAdd:"TDO",testdata:testDataJSON};
		sendAJAX(data,app_server_url,function(data){
		if(data["code"] == '200'){
			//alert("Saved successfully");
			console.log("Saved Test Data successfully");
			}else{
            dailogmsg(data["msg"]);
		}
	});
    }
	
$("#modal-close").click(function () {
	$("#modal-content-version").css("display", "none");
	$('.ui-igtrialwatermark').removeClass('bgopacity');
	
});

$("#select_model_tocopy").on("change", function () {
	var selected = $('#select_model_tocopy').find('option:selected').val();
	var data = {fileAdd:"SCOV",selected:selected};
    retriveModelversionDetails(data);
});

function retriveModelversionDetails(data){
	sendAJAX(data,app_server_url,function(data){
		if(data["code"] == '200'){
			console.log("Version details fetched");
			testCondDB=data.data;
			var tableLength = testCondDB.length;
			$('#select_version_tocopy').empty();
			if(tableLength > 0){
				$.each(testCondDB, function (index, each_row) {
					$('#select_version_tocopy').append($('<option>', {
						value:each_row.id,
						text: each_row.description
					}));
			});
		}else{
			$("#select_version_tocopy").append('<option>Select Version</option>');
		}
		}else{
			dailogmsg(data["msg"]);
		}		
	});
}
	
$("#modal-launcher").click(function () {

	var userName=session.userDetails.name;
	var currentDiagramId='';
	var currentNode = (currentSelectedNode.id).split("_")[0];
	if(currentNode == "diagram"){
		currentDiagramId = (currentSelectedNode.id).split("_")[1];
    }else if(currentNode == "version"){
		currentDiagramId = (currentSelectedNode.parent).split("_")[1];	
	}	
	var data = {fileAdd:"SCOM",userName:userName,diagId:currentDiagramId};
	sendAJAX(data,app_server_url,function(data){
		if(data["code"] == '200'){
			console.log("Module details fetched");
			testCondDB=data.data;
			var tableLength = testCondDB.length;
			
			if(tableLength > 0){
				$.each(testCondDB, function (index, each_row) {					
					if(each_row.vCount != undefined && each_row.vCount>0){
						$('#select_model_tocopy').empty();
						$('#select_model_tocopy').append($('<option>', {
							value:each_row.id,
							text: each_row.name
						}));
						$('#select_model_tocopy').prop('disabled', 'disabled');
						var data = {fileAdd:"SCOV",selected:each_row.id};
						retriveModelversionDetails(data);
					}else{
						$('#select_model_tocopy').append($('<option>', {
							value:each_row.id,
							text: each_row.name
						}));
					}
					
			});
		}
		}else{
            dailogmsg(data["msg"]);
		}		
	});
	$("#modal-content-version").css("display", "block");
	$('.ui-igtrialwatermark').addClass('bgopacity');
});


function  requirmentConformation(type){
	$('<div class="createReqmodal"  style="display: block;"  align="center">' +
	'<div id="header-modal" align="left">' +
	'<span>'+labelObj.dialogHeaderConfirm+'</span>' +
	'</div>' +
	'<div id="body-modal" class="popupbodytxt">' +
	'<div>'+ labelObj.requirementalertmsg+'</div>' +
	'<div id="footer-modal">' +
	'<input id="req-yes-'+type+'" type="button" value="'+labelObj.buttonYes+'">' +
	'<input id="req-no-'+type+'" type="button" value="'+labelObj.buttonNo+'">' +
	'</div>' +
	'</div>' +
	'</div>').appendTo('#popupdata');
    $('#modal-bg').addClass('bgopacity');
}


$(document).on("click","#req-yes-prev",function(){
	$(".createReqmodal").css("display","none");
	copyDefaultVersion = false;
	copyBlankVersion = false;
	var selectedVer = $('#select_version_tocopy').find('option:selected').val();
	if(currentSelectedNode.id == null || currentSelectedNode.id == ''){
        dailogmsg("Please select Diagram or Version to create copy.");
	}else{
		var currentNode = (currentSelectedNode.id).split("_")[0];
		if(currentNode == "diagram" || currentNode == "version"){

			var currentDiagramId;
			var curSelId;
			if(currentNode == "diagram"){
				currentDiagramId = (currentSelectedNode.id).split("_")[1];
				curSelId = currentSelectedNode.id;
			}else{
				currentDiagramId = (currentSelectedNode.parent).split("_")[1];
				curSelId = currentSelectedNode.parent;
			}

		     var data = {fileAdd:"SCOC",diagramId:currentDiagramId,selectedVer:selectedVer,copyDefaultVersion:copyDefaultVersion,copyBlankVersion:copyBlankVersion};
			 mapRequirementToModel(selectedVer,currentSelectedNode,data);			
		}else{
            dailogmsg("Cannot create Version under "+currentNode+". Select Diagram under which you want version to be created");
		}
		
	}
	
}); 

$(document).on("click","#req-no-prev",function(){
	$(".createReqmodal").css("display","none");
	 copyDefaultVersion = false;
	 copyBlankVersion = false;
	 var selectedVer = $('#select_version_tocopy').find('option:selected').val();
	 if(currentSelectedNode.id == null || currentSelectedNode.id == ''){
		 dailogmsg("Please select Diagram or Version to create copy.");
	 }else{
		 var currentNode = (currentSelectedNode.id).split("_")[0];
		 if(currentNode == "diagram" || currentNode == "version"){
 
			 var currentDiagramId;
			 var curSelId;
			 if(currentNode == "diagram"){
				 currentDiagramId = (currentSelectedNode.id).split("_")[1];
				 curSelId = currentSelectedNode.id;
			 }else{
				 currentDiagramId = (currentSelectedNode.parent).split("_")[1];
				 curSelId = currentSelectedNode.parent;
			 }
 
			  var data = {fileAdd:"SCOC",diagramId:currentDiagramId,selectedVer:selectedVer,copyDefaultVersion:copyDefaultVersion,copyBlankVersion:copyBlankVersion};
			  sendAJAX(data, app_server_url, function (data) {
				if (data["code"] == '200') {
					loadJSTree('onUpdate');
					dailogmsg(labelObj.modleVersionSucc);
				} else {
					dailogmsg(data.msg);
				}
			});			
		 }else{
			 dailogmsg("Cannot create Version under "+currentNode+". Select Diagram under which you want version to be created");
		 }
		 
	 }
	 
});

$("#modal-yes").click(function () {
	var selectedVer = $('#select_version_tocopy').find('option:selected').val();
	if(!(selectedVer == 'Select Version')){	
		$("#modal-content-version").css("display","none");
		$('.ui-igtrialwatermark').removeClass('bgopacity');	
		$("#modal-yes").removeClass('icon-btn-disable'); 
		requirmentConformation("prev");
	}else{
		dailogmsg(labelObj.modelNotFoundError);
	}	 
});

function mapRequirementToModel(selectedVer, currentSelectedNode, versionJson) {
	version_data = versionJson;
	var mappingData;
	var module_id = currentSelectedNode.parents[1].substring(currentSelectedNode.parents[1].indexOf("_") + 1, currentSelectedNode.parents[1].length);
	var requirementHTML = '';
	var reqName = '';
	$("#checkboxes").remove();
	var data = { fileAdd: "GID", module_id: module_id };
	sendAJAX(data, app_server_url, function (data) {
		$.each(data.data, function (key, value) {
			if (value.name.length > 30) {
				reqName = value.name.substring(0, 20) + "...";
			} else {
				reqName = value.name
			}
			requirementHTML += "<label for='" + value.issue_id + "'><input type='checkbox' id='" + value.issue_id + "' name='requimentcheck' value='" + reqName + "'/>" + reqName + "</label>";
		});
		$('<div class="createreqmodalData"  style="display: block;"  align="center">' +
			'<div id="header-modal" align="left">' +
			'<span>'+labelObj.dialogHeaderReqMap+'</span>' +
			'</div>' +
			'<div id="body-modal" class="popupbodytxt">' +
			'<div class="multiselect">' +
			'<span class="multiselectlabel">'+labelObj.selectRequirement+':</span><div class="multiselectdropdown"><div class="selectBox" onclick="showCheckboxes()"><select style="width:172px"><option style="display:none;">'+labelObj.select+'</option></select><div class="overSelectreq"></div></div>' +
			'<div id="checkboxes">' +
			'</div></div>' +
			'<div id="footer-modal" style="padding-top:53px;padding-left:60px;">' +
			'<input id="context-ok-req" type="button" value="'+labelObj.buttonOk+'">' +
			'<input id="context-on-req" type="button" value="'+labelObj.buttonCancel+'">' +
			'</div>' +
			'</div>' +
			'</div>').appendTo('#popupdata');
		$("#checkboxes").append(requirementHTML);
		$('#modal-bg').addClass('bgopacity');
		if (selectedVer != '') {
			var data = { fileAdd: "GMR", model_id: selectedVer };
			sendAJAX(data, app_server_url, function (data) {
				for (var index = 0; index < data.data.length; index++) {
					$("#" + data.data[index].requirement_id).prop('checked', true);
				}

			});
		}
	});

}

var expanded = false;
function showCheckboxes(){
	var checkboxes = document.getElementById("checkboxes");
	if (!expanded) {
	  checkboxes.style.display = "block";
	  expanded = true;
	} else {
	  checkboxes.style.display = "none";
	  expanded = false;
	}
}

$(document).on('click', '#context-ok-req', function () {
	var req_map_data = [];
	$('input[name="requimentcheck"]:checked').each(function () {
		req_map_data.push(this.id);
	});
	var data = version_data;
	data.req_map_data = req_map_data;
	sendAJAX(data, app_server_url, function (data) {
		if (data["code"] == '200') {
			loadJSTree('onUpdate');
			dailogmsg(labelObj.modleVersionSucc);
		} else {
			dailogmsg(data.msg);
		}
	});
	version_data = '';
	$(".createreqmodalData").css("display", "none");
	

});

$(document).on('click', '#context-on-req', function () {
	$(".createreqmodalData").css("display", "none");
	$('#modal-bg').removeClass('bgopacity');
});


$(document).on("click","#req-yes-close",function(){
	$(".createReqmodal").css("display","none");
    copyDefaultVersion = true;
	copyBlankVersion = false;
	var selectedVer = $('#select_version_tocopy').find('option:selected').val();
	if(currentSelectedNode.id == null || currentSelectedNode.id == ''){
        dailogmsg("Please select Diagram or Version to create copy.");
	}else{
		var currentNode = (currentSelectedNode.id).split("_")[0];
		if(currentNode == "diagram" || currentNode == "version"){

			var currentDiagramId;
			var curSelId;
			if(currentNode == "diagram"){
				currentDiagramId = (currentSelectedNode.id).split("_")[1];
				curSelId = currentSelectedNode.id;
			}else{
				currentDiagramId = (currentSelectedNode.parent).split("_")[1];
				curSelId = currentSelectedNode.parent;
			}
			var data = {fileAdd:"SCOC",diagramId:currentDiagramId,copyDefaultVersion:copyDefaultVersion,copyBlankVersion:copyBlankVersion};
			mapRequirementToModel(selectedVer,currentSelectedNode,data);
		}else{
            dailogmsg("Cannot create Version under "+currentNode+". Select Diagram under which you want version to be created");
		}
		
	}
	copyDefaultVersion = false;

});	

$(document).on("click","#req-no-close",function(){
	$(".createReqmodal").css("display","none");
	copyDefaultVersion = true;
	copyBlankVersion = false;
	var selectedVer = $('#select_version_tocopy').find('option:selected').val();
	if(currentSelectedNode.id == null || currentSelectedNode.id == ''){
        dailogmsg("Please select Diagram or Version to create copy.");
	}else{
		var currentNode = (currentSelectedNode.id).split("_")[0];
		if(currentNode == "diagram" || currentNode == "version"){

			var currentDiagramId;
			var curSelId;
			if(currentNode == "diagram"){
				currentDiagramId = (currentSelectedNode.id).split("_")[1];
				curSelId = currentSelectedNode.id;
			}else{
				currentDiagramId = (currentSelectedNode.parent).split("_")[1];
				curSelId = currentSelectedNode.parent;
			}
			var data = {fileAdd:"SCOC",diagramId:currentDiagramId,copyDefaultVersion:copyDefaultVersion,copyBlankVersion:copyBlankVersion};
			sendAJAX(data, app_server_url, function (data) {
				if (data["code"] == '200') {
					loadJSTree('onUpdate');
					dailogmsg(labelObj.modleVersionSucc);
				} else {
					dailogmsg(data.msg);
				}
			});
		}else{
            dailogmsg("Cannot create Version under "+currentNode+". Select Diagram under which you want version to be created");
		}
		
	}
	copyDefaultVersion = false;
	
});


$("#modal-close-version").click(function () {
	/*var selectedVer = $('#select_version_tocopy').find('option:selected').val();
	if(!(selectedVer == 'Select Version')){
		requirmentConformation("close");
		$("#createversionmodal").css("display","none");
		$('.ui-igtrialwatermark').removeClass('bgopacity');
	}else{
		$("#createversionmodal").css("display","none");
		dailogmsg("Existing model daigram's not found"); 
	}	*/
	  try{
		if(currentSelectedNode.id == null || currentSelectedNode.id == ''){
			dailogmsg("Please select Diagram or Version to create copy.");
		}else{
			var currentNode = (currentSelectedNode.id).split("_")[0];
			if(currentNode == "diagram" || currentNode == "version"){	
				var currentDiagramId;
				if(currentNode == "diagram"){
					currentDiagramId = (currentSelectedNode.id).split("_")[1];
				}else{
					currentDiagramId = (currentSelectedNode.parent).split("_")[1];
				}
				var data = {fileAdd:"CPVD",diagramId:currentDiagramId};
				sendAJAX(data, app_server_url, function (data) {
					if (data["code"] == '200') {
						$('#select_version_tocopy').val(data.data);
						requirmentConformation("close");					
					} else {
						dailogmsg(labelObj.modelNotFoundError);
					}
				});
			}else{
				dailogmsg("Please select Diagram or Version to create copy.");
			}		
		}
		$("#createversionmodal").css("display","none");
		$('.ui-igtrialwatermark').removeClass('bgopacity');
	  }catch(err){
		$("#createversionmodal").css("display","none");
		$('.ui-igtrialwatermark').removeClass('bgopacity');
	  }	
});

$(document).on("click","#req-yes-blank",function(){
	$(".createReqmodal").css("display","none");
    copyBlankVersion = true;
	copyDefaultVersion = false;
	var selectedVer = $('#select_version_tocopy').find('option:selected').val();
	if(currentSelectedNode.id == null || currentSelectedNode.id == ''){
        dailogmsg("Please select Diagram or Version to create copy.");
	}else{
		var currentNode = (currentSelectedNode.id).split("_")[0];
		if(currentNode == "diagram" || currentNode == "version"){

			var currentDiagramId;
			var curSelId;
			if(currentNode == "diagram"){
				currentDiagramId = (currentSelectedNode.id).split("_")[1];
				curSelId = currentSelectedNode.id;
			}else{
				currentDiagramId = (currentSelectedNode.parent).split("_")[1];
				curSelId = currentSelectedNode.parent;
			}
			var data = {fileAdd:"SCOC",diagramId:currentDiagramId,copyDefaultVersion:copyDefaultVersion,copyBlankVersion:copyBlankVersion};
			mapRequirementToModel(selectedVer,currentSelectedNode,data);
		}else{
            dailogmsg("Cannot create Version under "+currentNode+". Select Diagram under which you want version to be created");
		}
		
	}
	copyBlankVersion = false;
});

$(document).on("click","#req-no-blank",function(){
	$(".createReqmodal").css("display","none");
	copyBlankVersion = true;
	copyDefaultVersion = false;
	var selectedVer = $('#select_version_tocopy').find('option:selected').val();
	if(currentSelectedNode.id == null || currentSelectedNode.id == ''){
        dailogmsg("Please select Diagram or Version to create copy.");
	}else{
		var currentNode = (currentSelectedNode.id).split("_")[0];
		if(currentNode == "diagram" || currentNode == "version"){

			var currentDiagramId;
			var curSelId;
			if(currentNode == "diagram"){
				currentDiagramId = (currentSelectedNode.id).split("_")[1];
				curSelId = currentSelectedNode.id;
			}else{
				currentDiagramId = (currentSelectedNode.parent).split("_")[1];
				curSelId = currentSelectedNode.parent;
			}
			var data = {fileAdd:"SCOC",diagramId:currentDiagramId,copyDefaultVersion:copyDefaultVersion,copyBlankVersion:copyBlankVersion};
		    sendAJAX(data, app_server_url, function (data) {
				if (data["code"] == '200') {
					loadJSTree('onUpdate');
					dailogmsg(labelObj.modleVersionSucc);
				} else {
					dailogmsg(data.msg);
				}
			});
		}else{
            dailogmsg("Cannot create Version under "+currentNode+". Select Diagram under which you want version to be created");
		}
		
	}
	copyBlankVersion = false;
	});




$("#modal-blank-version").click(function () {
	requirmentConformation("blank");
	$("#createversionmodal").css("display","none");
	$('.ui-igtrialwatermark').removeClass('bgopacity');
});


$("#default-version").click(function () {
	
    var currentNode = (currentSelectedNode.id).split("_")[0];
    var currentDiagramId;
    var status=false;
    if(currentNode == "diagram"){
		currentDiagramId = (currentSelectedNode.id).split("_")[1];
		getDiagramList();
    }else if(currentNode == "version"){
		currentDiagramId = (currentSelectedNode.parent).split("_")[1];
		getDiagramList();
	}else{
		dailogmsg(labelObj.daigramModelCreateError);
	}
	function getDiagramList(){
		var data = {fileAdd:"DL",diagramId:currentDiagramId};
		sendAJAX(data,app_server_url,function(data){
			if(data["code"] == '200'){
				$("#createversionmodal").css("display", "block");
				$('.ui-igtrialwatermark').addClass('bgopacity');
			}else{
				$("#createversionmodal").css("display", "block");
			}
		});
	}
});	
$("#modal-yes-version").click(function () {
	$('#select_model_tocopy').prop('disabled', '');
	$('#select_model_tocopy').empty();
	$('#select_model_tocopy').append('<option>'+labelObj.selectModel+'</option>');
	$('#select_version_tocopy').empty();
	$("#select_version_tocopy").append('<option>'+labelObj.selectVersion+'</option>');
	$("#modal-content").css("display","block");
	$("#createversionmodal").css("display","none");
	$('.ui-igtrialwatermark').removeClass('bgopacity');
	$('#modal-launcher').click();
});

$('#dataTable').on('change', '[id=tes-cond-chk-all]', function(evt){
	if($(this).is(":checked")) {
		$("[id=tes-cond-chk-box]").prop('checked', true);
	}else{
		$("[id=tes-cond-chk-box]").prop('checked', false);
	}
});

$('#testDataTable').on('change', '[name=Selectall]', function(evt){
	if($(this).is(":checked")) {
		$("#testDataTable input[name=chk]").each( function () {
			$(this).prop('checked', true);
		});		
	}else{
		$("#testDataTable input[name=chk]").each( function () {
			$(this).prop('checked', false);
		});	
	}
});



